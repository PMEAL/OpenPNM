{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "38d84418",
   "metadata": {},
   "source": [
    "# Assigning Geometric Properties\n",
    "\n",
    "Geometric properties refer to the physical sizes of the pores and throats, such as pore diameter and throat lengths. The values are essential to the pore network modeling enterprize since they control all the transport and percolation behavior of the network. Unlike phase properties which can be normalized for, geometric properties define the network even more so than topological properties like connectivity. \n",
    "\n",
    "Geometric properties *can* be calculated by various means, ranging from assigning random values to pores, extracting values from tomographic images. OpenPNM provides a library of functions, or 'pore-scale models' which can calcuate these geometric properties automatically. This tutorial will cover the following subjects:\n",
    "\n",
    "| Subject |\n",
    "| :- |\n",
    "| Manually Calculating Pore and Throat Properties (⚠ Not Recommended!) |\n",
    "| Using Pore-scale Models from the Library |\n",
    "| Overview of the Dependency Handler |\n",
    "| Using Predefined Collections of Models |\n",
    "| Defining Heterogeneous Domains (by Applying Models to Specific Locations) |\n",
    "| Customizing Models (by Overwriting Them or Their Arguments) |\n",
    "| Writing and Using Custom Models |"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "94917bac",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import openpnm as op"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f63bbaee",
   "metadata": {},
   "source": [
    "Let's start by creating a blank Cubic network.  As we can see by printing it, there only coordinates, connections, and some labels, but no geometric properties:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "142050f5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "══════════════════════════════════════════════════════════════════════════════\n",
      "net : <openpnm.network.Cubic at 0x214c26523b0>\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "  #  Properties                                                   Valid Values\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "  1  pore.coords                                                   8000 / 8000\n",
      "  2  throat.conns                                                22800 / 22800\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "  #  Labels                                                 Assigned Locations\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "  1  pore.back                                                             400\n",
      "  2  pore.bottom                                                           400\n",
      "  3  pore.front                                                            400\n",
      "  4  pore.left                                                             400\n",
      "  5  pore.right                                                            400\n",
      "  6  pore.surface                                                         2168\n",
      "  7  pore.top                                                              400\n",
      "  8  throat.surface                                                       4332\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n"
     ]
    }
   ],
   "source": [
    "np.random.seed(0)\n",
    "pn = op.network.Cubic([20, 20, 20], spacing=5e-5)\n",
    "print(pn)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d7e40b76",
   "metadata": {},
   "source": [
    ".. attention:: Changed in V3\n",
    "\n",
    "    In OpenPNM V3 we have removed the concept of ``Geometry`` and ``Physics`` objects, in favor of placing all the properties on the ``Network`` and ``Phase`` objects instead. "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "35629fd2",
   "metadata": {},
   "source": [
    "To add geometrical properties to a network, we have a few different options.  Each will be explored below:"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "51da4915",
   "metadata": {},
   "source": [
    "## Manually Calculating Properties\n",
    "\n",
    ".. warning:: Manual Calculation is Not Recommended\n",
    "\n",
    "    This is not the preferred way to do things, but does illustrate the processes very well. The preferred way is using pore-scale models, which allow for the automatic regeneration of dependent properities when something changes. \n",
    "\n",
    "Let's start by adding pore and throat size distributions.  There are a few different ways to do this, and we'll explore each one to be thorough.  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f7ad8f43",
   "metadata": {},
   "source": [
    "### Adding pore and throat sizes from `scipy.stats` distributions\n",
    "\n",
    "Scipy's `stats` module has a *lot* of statistical distributions defined.  Let's generate pore and throat sizes using some of these.  First, let's use a normal distribution to generate pore sizes within the range ~1 to 50 um:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "7f638068",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "np.random.seed(0)\n",
    "import scipy.stats as spst\n",
    "psd = spst.norm.rvs(loc=25, scale=6, size=pn.Np)\n",
    "plt.hist(psd, edgecolor='k')\n",
    "plt.xlim([0, 50]);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "da11cebf",
   "metadata": {},
   "source": [
    "The above distribution looks good, let's just make absolutely sure that our distribution is not so wide that it has negative numbers or values greater than 50 um:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "8efcd33a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2.5593961722893255\n",
      "47.80996128980269\n"
     ]
    }
   ],
   "source": [
    "print(psd.min())\n",
    "print(psd.max())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "59b3a0eb",
   "metadata": {},
   "source": [
    "Now we'll convert these values to SI and assign to the network:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "98c6c031",
   "metadata": {},
   "outputs": [],
   "source": [
    "pn['pore.diameter'] = psd*1e-6  # um to m"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d3e52c17",
   "metadata": {},
   "source": [
    "Next we need to define throat diameters. We can do this in the same way, but let's use a different distribution.  Note that this approach is not recommended because as we'll see it results in throats that are larger than the two pores they are connected two.  We'll fix this in the following section:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "3dd8c095",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "np.random.seed(0)\n",
    "tsd = spst.weibull_min.rvs(c=1.5, loc=.5, scale=7.5, size=pn.Nt)\n",
    "plt.hist(tsd, edgecolor='k')\n",
    "plt.xlim([0, 50]);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "60cc7cb1",
   "metadata": {},
   "source": [
    "Again, let's inspect the high and low values:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "6dee2380",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.5130345457395142\n",
      "36.96861960231873\n"
     ]
    }
   ],
   "source": [
    "print(tsd.min())\n",
    "print(tsd.max())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9fb4889c",
   "metadata": {},
   "source": [
    "So we can see that we have throats as small as 500 nm, and as large as 37 um.  These can be assigned to the network as well:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "e1cf0757",
   "metadata": {},
   "outputs": [],
   "source": [
    "pn['throat.diameter'] = tsd*1e-6  # um to m"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "73a09aab",
   "metadata": {},
   "source": [
    "The problem with this approach is that both pore and throat sizes were just assigned to random locations, rather than putting small throats between small pores and vice-versa. When throats are larger than the pores they connect it can cause problems or strangeness in the results since we generally assume a throat is a constriction between two pores.  Let's count how many are problematic."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "a6e0cbbd",
   "metadata": {},
   "outputs": [],
   "source": [
    "hits = np.any(pn['pore.diameter'][pn.conns].T < pn['throat.diameter'], axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "b27b6342",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "564"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hits.sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f403af58",
   "metadata": {},
   "source": [
    ".. tip:: Indexing pore properties by `conns`\n",
    "    \n",
    "    Using the ``conns`` array to index into a pore property returns an Nt-by-2 array with the properties of the pores on the end of a throat in each column.  For instance, so see the diameter of the pore on each end of a throat, use ``pn['pore.diameter'][pn.conns]``.  This approach is very powerful.  If you ever feel tempted to use a for-loop to scan over each pore, then inspect the properties of the neighboring throats, consider instead if you can \"loop\" over the throats then interogate each pore.  If yes, then you can use this conns-indexing trick."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0eb07950",
   "metadata": {},
   "source": [
    "There are two *safer* ways to assign pore and throat sizes, to ensure that throats are smaller than the pores they connected.  The first is to proceed as above by assign pore sizes randomly, *then* assigning throats to be the *as small (or smaller) as the smallest pore it is connected to*.  This can be done using some `numpy` functions as follows:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "369bc582",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "tsd = np.amin(pn['pore.diameter'][pn.conns], axis=1)\n",
    "plt.hist(tsd, edgecolor='k', density=True, alpha=0.5)\n",
    "plt.hist(pn['pore.diameter'], edgecolor='k', density=True, alpha=0.5)\n",
    "plt.xlim([0, 50e-6]);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c15ad2b2",
   "metadata": {},
   "source": [
    "We can see from the above plot that the throat sizes are similar to the pore sizes, which is expected since they are taken from the pore sizes values. However, we can also see a small shift to the left, which is also expected given that the throats always take on the size of the smaller pore, creating a bias towards smaller sizes."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "acce746c",
   "metadata": {},
   "source": [
    "It may also be desirable to force the throats to be smaller than the two neighboring pores by some factor:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "ceca301c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "pn['throat.diameter'] = tsd*0.5\n",
    "plt.hist(pn['throat.diameter'], edgecolor='k', density=True, alpha=0.5)\n",
    "plt.hist(pn['pore.diameter'], edgecolor='k', density=True, alpha=0.5)\n",
    "plt.xlim([0, 50e-6]);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9d309397",
   "metadata": {},
   "source": [
    "One downside of the above approach is that you no longer have control over the shape and distribution of the throat sizes. This can be solved by applying the same approach just described but to random seeds instead of actual sizes. Then the random seeds can be put into a cumulative density function to compute the corresponding size.  This is demonstrated below:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "a5300fc4",
   "metadata": {},
   "outputs": [],
   "source": [
    "lo, hi = 0.01, 0.99\n",
    "pn['pore.seed'] = np.random.rand(pn.Np)*(hi - lo) + lo"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8dae3979",
   "metadata": {},
   "source": [
    ".. tip::\n",
    "\n",
    "    Setting the `lo` and `hi` values of the the seeds prevents values that lie far out in the tail of a distribution from occurring which can lead to overly large pores or throats."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8a1c8006",
   "metadata": {},
   "source": [
    "The `ppf` function, or *point probability function* returns the value of a cumulative distribution at the given probability, so the seed values computed above can be related to size values using:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "26d114de",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import scipy.stats as spst\n",
    "psd = spst.norm.ppf(loc=25, scale=6, q=pn['pore.seed'])\n",
    "pn['pore.diameter'] = psd*1e-6\n",
    "plt.hist(pn['pore.diameter'], edgecolor='k')\n",
    "plt.xlim([0, 50e-6]);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a5adfbfa",
   "metadata": {},
   "source": [
    "Now we can find the throat seed values as the *minimum pore seed* value of the two neighboring pores:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "8b88f316",
   "metadata": {},
   "outputs": [],
   "source": [
    "pn['throat.seed'] = np.amin(pn['pore.seed'][pn.conns], axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5d1c6c94",
   "metadata": {},
   "source": [
    "And then we can use these seed values in the `ppf` function of the desired distribution. So long as the distribution does not create larger values than the distribution used to compute pore sizes, then the throat sizes will always be smaller."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "895c820d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "tsd = spst.norm.ppf(loc=25, scale=6, q=pn['throat.seed'])\n",
    "pn['throat.diameter'] = tsd*1e-6\n",
    "plt.hist(pn['throat.diameter'], edgecolor='k', density=True, alpha=0.5)\n",
    "plt.hist(pn['pore.diameter'], edgecolor='k', density=True, alpha=0.5)\n",
    "plt.xlim([0, 50e-6]);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "7c3c2104",
   "metadata": {},
   "source": [
    "Once the pore and throat diameters are specified, the next step is to define any dependent properties of interest, such as pore volume or throat length. These additional calculations tend to require that we assume a shape for the pores and throats.  It is not mandatory to use spheres and cylinders, though this is a common choice.  We could also work with cubic pores and cuboid throats, which occupy a large volume fraction for instance.  The choice of cubic shapes also happens to make the calculations much easier, for reasons explored below, so in this tutorial we'll assume cubic shapes.  Let's calculate the throat length, and pore surface area, since each of these illustrate very important concepts regarding the use of vectorized calculations."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "15cdc018",
   "metadata": {},
   "source": [
    "### Computing throat length\n",
    "\n",
    "Throat length is the pore-to-pore spacing, less the radius of each pore.  This can be found without the need for a for-loop using the following vectorization trick:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "9c8bc582",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[5.e-05 5.e-05 5.e-05 ... 5.e-05 5.e-05 5.e-05]\n"
     ]
    }
   ],
   "source": [
    "R1, R2 = (pn['pore.diameter'][pn.conns]/2).T\n",
    "L_total = np.sqrt(np.sum(np.diff(pn.coords[pn.conns], axis=1).squeeze()**2, axis=1))\n",
    "Lt = L_total - R1 - R2\n",
    "print(L_total)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f68b01d8",
   "metadata": {},
   "source": [
    "The above cell contains 3 complicated but powerful steps:\n",
    "1. The radii of the pores on each end of each throat are retrieved. `R1` and `R2` contain duplicates since each pore has numerous throats, so they appear once for each throat. This fact is used in step 3.\n",
    "2. The pore-to-pore distance is found by retrieving the coordinates of each pore, in the same was as was done for the radii. The Euclidean distance between each pair of pores is then computed by finding their difference (`np.diff`), squaring it, summing it (`np.sum`), then taking the square root (`np.sqrt`) of each. The `axis` argument is used throughout to tell numpy which way to apply the operation. This line is an example of how you must learn a *mini-language* to use numpy effectively. \n",
    "3. The length of each throat is found as the spacing between pores, less the radii the pore on each end. This is where the duplicate values in `R1` and `R2` are necessary, since the radii of pore *i* must be subtracted from length of each of it's neighboring throats.\n",
    "\n",
    "The main take-home message here is that throat properties can be computed in a vectorized way, even if some pore-properties are required. This avoids the use of a for-loop to scan through a list of throats followed by a nested for-loop to scan through each neighboring pore."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d57f31e0",
   "metadata": {},
   "source": [
    "### Computing pore surface areas\n",
    "The pore surface area is the total area of the cubic pore body, less the cross-sectional area of each neighboring throat. This can also be found without a for-loop, but requires knowing some deeper `numpy` functionality, known as [unbuffered in-place operations](https://numpy.org/doc/stable/reference/generated/numpy.ufunc.at.html):"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "9850978b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[9.08485305e-10 5.68134509e-09 2.33947201e-09 ... 6.57211706e-10\n",
      " 1.92152447e-09 1.72429278e-09]\n"
     ]
    }
   ],
   "source": [
    "At = pn['throat.diameter']**2\n",
    "SAp = (pn['pore.diameter']**2)*6\n",
    "np.subtract.at(SAp, pn.conns[:, 0], At)\n",
    "np.subtract.at(SAp, pn.conns[:, 1], At)\n",
    "print(SAp)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a1f2c36",
   "metadata": {},
   "source": [
    "The above cell contains 2 lines of importance, which each do almost the same thing:\n",
    "1. The first line subtracts the throat cross-sectional area from each pore listed in the first column of the `pn.conns` array. Since a given pore is connected to potentially many throats, the subtraction must be done using `np.substract.at` which is a special version of the subtract function that subtracts every value in `At` from the locations in `SAp` indicated by `pn.conn[:, 0]`, and it does so in a cumulative fashion. Thus if pore *i* appears in `pn.conns[:, 0]` more than once, then more than one value of `At` is removed. The operation is performed *in-place* so that no array is returned.\n",
    "2. Recall that `pn.conns` contains only the upper-triangular entries of the adjacency matrix, so this process only gets half of the connections. This means that the pore connectioned found in `pn.conns[:, 1]` must also be analyzed."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4ef26402",
   "metadata": {},
   "source": [
    "## Using Pore-scale Models from the Library\n",
    "\n",
    "The above section is quite lengthy, but lays bare the process of computing geometric properties of a network for illustration purposes.  In this section we'll utilize OpenPNM's library of 'pore-scale' models to get the same job done much more easily. Start by generating a fresh network:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "4c7e5341",
   "metadata": {},
   "outputs": [],
   "source": [
    "np.random.seed(0)\n",
    "pn = op.network.Cubic([20, 20, 20], spacing=5e-5)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "460a0434",
   "metadata": {},
   "source": [
    "First let's assign a random number to each pore, but instead of using `np.random.rand` directly, we'll use a pore-scale model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "ba5de6a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "f = op.models.geometry.pore_seed.random\n",
    "pn.add_model(propname='pore.seed', \n",
    "             model=f,\n",
    "             seed=None,  # Seed value provided to numpy's random number generator.\n",
    "             num_range=[0.01, 0.99],)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9421fc7f",
   "metadata": {},
   "source": [
    ".. note:: Where do models go?\n",
    "\n",
    "    We'll look more closely at models later in this tutorial, but it's worth pointing out that the `add_model` method collects all the arguments provided and stores them in the `models` attribute of the object. Later, when `regenerate_models` is called, it looks into the `models` attribute and fetches the model (`f`) and the given arguments, calls the function, collects the returned result, and stores them in `pn[propname]`. You can see a list of models applied to the object with `print(pn.models)`. "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cb01c08b",
   "metadata": {},
   "source": [
    "Let's have each throat inherit the minimum seed value found in each of its neighboring pores, for which OpenPNM provides a model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "5529e24c",
   "metadata": {},
   "outputs": [],
   "source": [
    "f = op.models.geometry.throat_seed.from_neighbor_pores\n",
    "pn.add_model(propname='throat.seed', \n",
    "             model=f,\n",
    "             prop='pore.seed',\n",
    "             mode='min')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "72d55b9b",
   "metadata": {},
   "source": [
    ".. tip:: Using shift-tab to see the docstring\n",
    "\n",
    "    In the above two code blocks the models were assigned to `f` first, then `f` was passed to the `model` argument. This is helpful for two reasons.  (1) It helps keep the line length below Python's preferred limit of 78 characters, and (2) it makes it possible to see the docstring of the model by putting the cursor at the end of the first line and hitting `shift-tab`. Seeing the docstring really helps to understand what a model does and what arguments are required."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2b9bec66",
   "metadata": {},
   "source": [
    "Now we can compute pore and throat sizes from distributions, which are also provided as OpenPNM models:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "3ddc9a3d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "f = op.models.geometry.pore_size.normal\n",
    "pn.add_model(propname='pore.diameter',\n",
    "             model=f,\n",
    "             scale=1e-5, \n",
    "             loc=2.5e-5,\n",
    "             seeds='pore.seed')\n",
    "plt.hist(pn['pore.diameter'], edgecolor='k');"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a7232364",
   "metadata": {},
   "source": [
    "And similarly we fetch a model for the throat sizes as well:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "0a2adc8e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "f = op.models.geometry.throat_size.normal\n",
    "pn.add_model(propname='throat.diameter',\n",
    "             model=f,\n",
    "             scale=1e-5, \n",
    "             loc=2.5e-5)\n",
    "plt.hist(pn['pore.diameter'], edgecolor='k', density=True, alpha=0.5)\n",
    "plt.hist(pn['throat.diameter'], edgecolor='k', density=True, alpha=0.5);"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "27579da1",
   "metadata": {},
   "source": [
    "Now that we have pore and throat sizes, we can compute their volumes (and other properties). The volume will depend on the shape of the pores and throats.  In OpenPNM we do not explicitly track such *shapes*.  Instead we offer several models that calculate the property of interest for a given shape. This is illustrated below:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "01d0e7e7",
   "metadata": {},
   "outputs": [],
   "source": [
    "f = op.models.geometry.throat_length.spheres_and_cylinders\n",
    "pn.add_model(propname='throat.length',\n",
    "             model=f)\n",
    "f1 = op.models.geometry.pore_volume.sphere \n",
    "pn.add_model(propname='pore.volume',\n",
    "             model=f1)\n",
    "f2 = op.models.geometry.throat_volume.cylinder\n",
    "pn.add_model(propname='throat.volume',\n",
    "             model=f2)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f9628d8c",
   "metadata": {},
   "source": [
    ".. warning:: Spherical pores overlap with their throats\n",
    "    \n",
    "    A spherical pore will always have a region of overlap with it's connected throats. The volume of this region will be double counted if an extra step is not taken. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "94e06d54",
   "metadata": {},
   "outputs": [],
   "source": [
    "f = op.models.geometry.throat_length.spheres_and_cylinders\n",
    "pn.add_model(propname='throat.length',\n",
    "             model=f)\n",
    "f1 = op.models.geometry.pore_volume.sphere \n",
    "pn.add_model(propname='pore.volume',\n",
    "             model=f1)\n",
    "f2 = op.models.geometry.throat_volume.cylinder\n",
    "pn.add_model(propname='throat.total_volume',\n",
    "             model=f2)\n",
    "f3 = op.models.geometry.throat_volume.lens\n",
    "pn.add_model(propname='throat.lens_volume',\n",
    "             model=f3)\n",
    "f4 = op.models.misc.difference\n",
    "pn.add_model(propname='throat.volume',\n",
    "             model=f4,\n",
    "             props=['throat.total_volume', 'throat.lens_volume'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "36d6d236",
   "metadata": {},
   "source": [
    "We can inspect some of these values to make sure they are making sense:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "682f95fd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Volumes of full throats: [1.70606123e-14 1.49642200e-14 8.56617280e-15]\n",
      "Volumes of lenses: [4.30295464e-15 3.70683677e-15 1.60690817e-15]\n",
      "Actual throat volumes: [1.27576577e-14 1.12573832e-14 6.95926463e-15]\n"
     ]
    }
   ],
   "source": [
    "print(\"Volumes of full throats:\", pn['throat.total_volume'][:3])\n",
    "print(\"Volumes of lenses:\", pn['throat.lens_volume'][:3])\n",
    "print(\"Actual throat volumes:\", pn['throat.volume'][:3])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "21dda2c5",
   "metadata": {},
   "source": [
    "## Using Predefined Collections of Models\n",
    "\n",
    "The process of selecting all the correct models from the `models` library can be tedious and error prone. In OpenPNM V3 we have introduced the concept of model *collections*, which are predfined dictionaries of models that form a complete and correct geometry. For instance, there is a collection called `spheres_and_cylinders`, which contains all the needed models to describe this geometry.  \n",
    "\n",
    "These collections are found under `openpnm.models.collections`, and their use is outlined below:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "8ff9e8b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "pn = op.network.Cubic(shape=[20, 20, 20], spacing=5e-5)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bdb85f3e",
   "metadata": {},
   "source": [
    "The models *collection* is fetched as follows:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "0260c363",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'pore.seed': {'model': <function random at 0x00000214C12504C0>, 'element': 'pore', 'num_range': [0.2, 0.7], 'seed': None}, 'pore.max_size': {'model': <function largest_sphere at 0x00000214C21D0EE0>, 'iters': 10}, 'pore.diameter': {'model': <function product at 0x00000214C1250DC0>, 'props': ['pore.max_size', 'pore.seed']}, 'pore.volume': {'model': <function sphere at 0x00000214C21D6550>, 'pore_diameter': 'pore.diameter'}, 'throat.max_size': {'model': <function from_neighbor_pores at 0x00000214C125F160>, 'mode': 'min', 'prop': 'pore.diameter'}, 'throat.diameter': {'model': <function scaled at 0x00000214C1250E50>, 'factor': 0.5, 'prop': 'throat.max_size'}, 'throat.length': {'model': <function spheres_and_cylinders at 0x00000214C21F58B0>, 'pore_diameter': 'pore.diameter', 'throat_diameter': 'throat.diameter'}, 'throat.cross_sectional_area': {'model': <function cylinder at 0x00000214C21D6E50>, 'throat_diameter': 'throat.diameter'}, 'throat.volume': {'model': <function cylinder at 0x00000214C21FB670>, 'throat_diameter': 'throat.diameter', 'throat_length': 'throat.length'}, 'throat.diffusive_size_factors': {'model': <function spheres_and_cylinders at 0x00000214C2239700>, 'pore_diameter': 'pore.diameter', 'throat_diameter': 'throat.diameter'}, 'throat.hydraulic_size_factors': {'model': <function spheres_and_cylinders at 0x00000214C222E310>, 'pore_diameter': 'pore.diameter', 'throat_diameter': 'throat.diameter'}}\n"
     ]
    }
   ],
   "source": [
    "mods = op.models.collections.geometry.spheres_and_cylinders\n",
    "print(mods)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "505c0189",
   "metadata": {},
   "source": [
    "The print-out of the dictionary is not very nice, but it can be seen that the keys are the model names, and the values are the model itself and the various arguments for the model.  This dictionary can be added to the network using the `add_models_collection` method as follows:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "3756bc09",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "══════════════════════════════════════════════════════════════════════════════\n",
      "net : <openpnm.network.Cubic at 0x214c5c05c70>\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "  #  Properties                                                   Valid Values\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "  1  pore.coordination_number                                      8000 / 8000\n",
      "  2  pore.coords                                                   8000 / 8000\n",
      "  3  pore.diameter                                                 8000 / 8000\n",
      "  4  pore.max_size                                                 8000 / 8000\n",
      "  5  pore.seed                                                     8000 / 8000\n",
      "  6  pore.volume                                                   8000 / 8000\n",
      "  7  throat.conns                                                22800 / 22800\n",
      "  8  throat.cross_sectional_area                                 22800 / 22800\n",
      "  9  throat.diameter                                             22800 / 22800\n",
      " 10  throat.diffusive_size_factors                               22800 / 22800\n",
      " 11  throat.hydraulic_size_factors                               22800 / 22800\n",
      " 12  throat.length                                               22800 / 22800\n",
      " 13  throat.max_size                                             22800 / 22800\n",
      " 14  throat.spacing                                              22800 / 22800\n",
      " 15  throat.volume                                               22800 / 22800\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "  #  Labels                                                 Assigned Locations\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "  1  pore.all                                                             8000\n",
      "  2  pore.back                                                             400\n",
      "  3  pore.bottom                                                           400\n",
      "  4  pore.front                                                            400\n",
      "  5  pore.left                                                             400\n",
      "  6  pore.right                                                            400\n",
      "  7  pore.surface                                                         2168\n",
      "  8  pore.top                                                              400\n",
      "  9  throat.all                                                          22800\n",
      " 10  throat.surface                                                       4332\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n"
     ]
    }
   ],
   "source": [
    "pn.add_model_collection(mods)\n",
    "pn.regenerate_models()\n",
    "print(pn)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6814eb17",
   "metadata": {},
   "source": [
    "## Customizing Models by Overwriting Them or Their Arguments\n",
    "\n",
    "The pre-written models and collections included with OpenPNM are helpful, but you'll almost always want to adjust some of the models to suit a specific application. This can be done by either altering the arguments of existing models, or by overwriting them all together. \n",
    "\n",
    "Let's first look at replacing a model with one of our choice.  The `spheres_and_cylinders` collection uses a random distribution of pore sizes, bounded between 0 and the distance to the nearest neighbor. This can be inspected by printing the specific model as follows:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "24933005",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "Property Name             Parameter                 Value\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "pore.diameter             model:                    product\n",
      "                          props:                    ['pore.max_size', 'pore.seed']\n",
      "                          regeneration mode:        deferred\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n"
     ]
    }
   ],
   "source": [
    "print(pn.models['pore.diameter@all'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "99103ed9",
   "metadata": {},
   "source": [
    ".. note:: The @ Notation\n",
    "\n",
    "    The @all that has been added to the model name is new in Version 3 and means that this model should be applied to pore that have the label `'pore.all'`. This will be explained in detail in the next tutorial. "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "29bf7355",
   "metadata": {},
   "source": [
    "Let's replace this with a normal distribution. This can be done with the `add_model` method as before. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "e68addce",
   "metadata": {},
   "outputs": [],
   "source": [
    "f = op.models.geometry.pore_size.normal\n",
    "pn.add_model(propname='pore.diameter',\n",
    "             model=f,\n",
    "             scale=1e-5, \n",
    "             loc=2.5e-5,\n",
    "             seeds='pore.seed')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "327e87a3",
   "metadata": {},
   "source": [
    "Now print the model again to ensure it was updated:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "e687fdd7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "Property Name             Parameter                 Value\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "pore.diameter             model:                    normal\n",
      "                          scale:                    1e-05\n",
      "                          loc:                      2.5e-05\n",
      "                          seeds:                    pore.seed\n",
      "                          regeneration mode:        normal\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n"
     ]
    }
   ],
   "source": [
    "print(pn.models['pore.diameter@all'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "03b97a60",
   "metadata": {},
   "source": [
    "And let's inspect the values:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "abf73f2b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.hist(pn['pore.diameter'], edgecolor='k');"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4635252e",
   "metadata": {},
   "source": [
    "This distribution is quite truncated, due to the `'pore.seed'` values that were used.  Let's reach into that model and change this.  First print the model:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "d5e4fac7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "Property Name             Parameter                 Value\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n",
      "pore.seed                 model:                    random\n",
      "                          element:                  pore\n",
      "                          num_range:                [0.2, 0.7]\n",
      "                          seed:                     None\n",
      "                          regeneration mode:        deferred\n",
      "――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――\n"
     ]
    }
   ],
   "source": [
    "print(pn.models['pore.seed@all'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9d70dd11",
   "metadata": {},
   "source": [
    "We can see that the `num_range` argument is quite constrained, so let's change it. Each model is itself a dictionary, so we can overwrite as follows:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "e316f20c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "pn.models['pore.seed@all']['num_range'] = [0.01, 0.99]\n",
    "pn.regenerate_models()\n",
    "plt.hist(pn['pore.diameter'], edgecolor='k');"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e880f2ee",
   "metadata": {},
   "source": [
    "## Introduction to the Dependency Handler\n",
    "\n",
    "Pore-scale models clearly make life easier since you don't have to produce the complex numpy functions by hand each time, but this is not even their best feature. The main benefit of pore-scale models is that they can be *recomputed* automatically. For instance, if we re-run the `'pore.seed'` model, then all the other models that depend on `'pore.seed'` will automatically be reomcomputed as well. This all occurs when we call `regenerate_models`, as demonstrated below:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "07e6f7fe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.93922037 0.61280983 0.92348118 ... 0.70619142 0.39657606 0.66479834]\n",
      "[2.78664997e-05 2.78664997e-05 1.19060194e-05 ... 2.75050628e-05\n",
      " 2.23778038e-05 2.92559453e-05]\n"
     ]
    }
   ],
   "source": [
    "pn = op.network.Cubic(shape=[20, 20, 20], spacing=5e-5)\n",
    "pn.add_model(propname='pore.seed',\n",
    "             model=op.models.geometry.pore_seed.random)\n",
    "pn.add_model(propname='pore.diameter',\n",
    "             model=f,\n",
    "             scale=1e-5, \n",
    "             loc=2.5e-5,\n",
    "             seeds='pore.seed')\n",
    "pn.add_model(propname='throat.seed',\n",
    "             model=op.models.geometry.throat_seed.from_neighbor_pores,\n",
    "             prop='pore.seed')\n",
    "pn.add_model(propname='throat.diameter',\n",
    "             model=f,\n",
    "             scale=1e-5, \n",
    "             loc=2.5e-5,\n",
    "             seeds='throat.seed')\n",
    "print(pn['pore.seed'])\n",
    "print(pn['throat.diameter'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "95915c96",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[0.0827237  0.85042386 0.99185044 ... 0.40135846 0.82144676 0.48632003]\n",
      "[1.11301848e-05 3.53825302e-05 1.97664028e-05 ... 2.25016755e-05\n",
      " 2.11391399e-06 2.46570267e-05]\n"
     ]
    }
   ],
   "source": [
    "pn.regenerate_models()\n",
    "print(pn['pore.seed'])\n",
    "print(pn['throat.diameter'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8ed8615a",
   "metadata": {},
   "source": [
    "As we can see above the initial values of `'pore.seed'` and `'throat.diameter'` are both changed after calling `regenerate_models()`. OpenPNM does this automaticall by inspecting the arguments to each function. \n",
    "\n",
    "Inspecting the `add_model` calls above we can see:\n",
    "\n",
    "1. The `'throat.seed'` model takes `'pore.seed'` as an argument\n",
    "2. The `'throat.diameter'` model takes `'throat.seed'` as an argument\n",
    "3. The `'pore.diameter'` models takes `'pore.seed'` as an argument\n",
    "\n",
    "So when `regenerate_models` is called it first re-runs the `'pore.seed'` model, which has no dependencies, then it re-runs the `'throat.seed'` model, then `'throat.diameter'`, in that order based on their dependencies. It also calls `'pore.diameter'`, but no other models depend on this. The dependency handling is done by creating a graph or network using `networkx` then do a special sort to find the top of the tree and all the downstream dependencies.  This can be roughly visualized using:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "id": "4080b43e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "pn.models.dependency_map(style='planar');"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c641bb09",
   "metadata": {},
   "source": [
    "The green circles are pore properties and the orange squares are throat properties. We can also see that there are two models which are not dependent on anything else: `'throat.spacing'` and `'pore.coordination_number'`.  These are added to all networks during generation but not run, hence their values do no show up when doing `print(pn)`."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bcc3cfce",
   "metadata": {},
   "source": [
    "It is also possible to make your own plot if you wish, by retrieving the dependency graph then calling the `networkx` plotting function of your choice:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "fde9676e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import networkx as nx\n",
    "g = pn.models.dependency_graph()\n",
    "fig, ax = plt.subplots(figsize=[5, 5])\n",
    "nx.draw_networkx\n",
    "nx.draw_planar(g, labels={k: k for k, v in g.nodes.items()}, ax=ax)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
