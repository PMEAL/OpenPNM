
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Tutorial 3 - Advanced &#8212; OpenPNM 2.8.2.dev111141 documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/reference/uncategorized/intro_to_openpnm_advanced';</script>
    <script src="../../../_static/js/custom.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Geometry of Imported Networks" href="managing_geometrical_properties_of_imported_networks.html" />
    <link rel="prev" title="The Workspace and Projects" href="../workspace/overview_of_workspace_and_projects.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="None">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fas fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../index.html">

  
  
  
  
  
  
  

  
    <img src="../../../_static/openpnm_logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../../../_static/openpnm_logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class=" navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../../../user_guide/installation.html">
                        Installation
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../user_guide/index.html">
                        User Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../modules/index.html">
                        Module Reference
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="../../../examples_index.html">
                        Examples
                    </a>
                </li>
                

            <li class="nav-item">
                <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/issues">Issue Tracker<i class="fas fa-external-link-alt"></i></a>
            </li>
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
            <li class="nav-item">
                <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/discussions">Get Help<i class="fas fa-external-link-alt"></i></a>
            </li>
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
  <i class="fas fa-search"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://github.com/PMEAL/OpenPNM" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://twitter.com/OpenPNM" title="Twitter" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
  <i class="fas fa-search"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fas fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../../../user_guide/installation.html">
                        Installation
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../user_guide/index.html">
                        User Guide
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../modules/index.html">
                        Module Reference
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="../../../examples_index.html">
                        Examples
                    </a>
                </li>
                

            <li class="nav-item">
                <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/issues">Issue Tracker<i class="fas fa-external-link-alt"></i></a>
            </li>
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
            <li class="nav-item">
                <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/discussions">Get Help<i class="fas fa-external-link-alt"></i></a>
            </li>
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://github.com/PMEAL/OpenPNM" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://twitter.com/OpenPNM" title="Twitter" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../getting_started/concise_overview_of_openpnm.html">
   Concise Overview of OpenPNM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../getting_started/intro_to_openpnm_basic.html">
   Tutorial 1 - Basic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../getting_started/intro_to_openpnm_intermediate.html">
   Tutorial 2 - Intermediate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../getting_started/quick_plotting_networks.html">
   Quick Plotting Networks
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/adding_boundary_pores.html">
   Adding Boundary Pores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/coupling_continuum_regions_with_pore_networks.html">
   Stitch Two Networks with Different Spacing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/cubic_networks.html">
   Cubic Lattice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/cubic_templates.html">
   Cubic Template
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/dual_cubic_lattices.html">
   Dual Cubic Lattice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/finding_neighbor_pores_and_throats.html">
   Querying the Topology to Find Neighbors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/manually_adding_pores_and_throats.html">
   Manually Adding and Removing Pores and Throats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/random_networks_based_on_delaunay_and_voronoi_tessellations.html">
   Delaunay and Voronoi Tessalation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/network/stitching_and_merging_networks_together.html">
   Stitching and Merging Networks
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/geometry/adjusting_pore_size_distributions.html">
   Adjusting Pore Size Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/geometry/stick_and_ball.html">
   The Stick and Ball Geometry
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/phase/empty_example.html">
   Empty example!
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../tutorials/physics/pore_scale_models.html">
   Pore Scale Models
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/percolation/A_ordinary_percolation.html">
   Ordinary Percolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/percolation/B_invasion_percolation.html">
   Invasion Percolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/percolation/C_mixed_invasion_percolation.html">
   Mixed Invasion Percolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/percolation/D_meniscus_model_comparison.html">
   Meniscus Model Comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/percolation/capillary_pressure_curves.html">
   Mercury Intrusion Porosimetry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/percolation/relative_diffusivity.html">
   Relative Diffusivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/percolation/relative_permeability_metrics.html">
   Relative Permeability
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/steady_state/continuum_heat_transfer.html">
   Fourier Conduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/steady_state/deep_dive_into_conductance_models.html">
   Deep Dive into Conductance Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/steady_state/diffusion_with_concentration_dependent_diffusivity.html">
   Fickian Diffusion with Variable Diffusivity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/steady_state/fickian_diffusion_and_tortuosity.html">
   Fickian Diffusion and Tortuosity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/steady_state/stokes_flow_and_permeability_tensor.html">
   Stokes Flow and Permeability Tensor
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/reactive/diffusion_with_source_and_sink_terms.html">
   Fickian Diffusion with Reaction
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/transient/transient_advection_diffusion.html">
   Transient Advection-Diffusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/transient/transient_fickian_diffusion.html">
   Transient Fickian Diffusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/transient/transient_fickian_diffusion_with_reaction.html">
   Transient Fickian Diffusion with Reaction
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../simulations/multiphysics/advection_diffusion.html">
   Advection-Diffusion
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../contrib/fibrous_media_based_on_voronoi_tessellation.html">
   Fibrous Media with Voronoi Tessellations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contrib/loading_statoil_finding_permeability.html">
   Part 1: Import Networks from Statoil Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contrib/maze_solver.html">
   Maze Solver
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contrib/ordinary_percolation.html">
   Simulating Drainage with Ordinary Percolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../contrib/predicting_effective_permeability_of_berea.html">
   Predicting Permeability of Berea
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../class_inheritance/creating_a_custom_phase.html">
   Creating a Custom Phase
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../class_inheritance/overview_of_inheritance.html">
   Overview of Inheritance
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../data_management/data_and_topology_storage.html">
   Storage of Network Data and Topology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data_management/data_exchange_between_objects.html">
   Data Exchange Between Objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data_management/interleaving_data.html">
   Interleaving Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data_management/using_and_creating_labels.html">
   Using and Creating Labels
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../settings/deep_dive_into_the_settings_attribute.html">
   Overview of the Settings Attribute
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../settings/understanding_basic_transport_settings.html">
   Understanding Basic Transport Settings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../settings/understanding_reactive_transport_settings.html">
   Understanding Reactive Transport Settings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../settings/understanding_transient_transport_settings.html">
   Understanding Transient Transport Settings
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../solvers/available_matrix_solvers.html">
   Available Matrix Solvers
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../workspace/overview_of_subdomains.html">
   Overview of Subdomains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../workspace/overview_of_workspace_and_projects.html">
   The Workspace and Projects
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Tutorial 3 - Advanced
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="managing_geometrical_properties_of_imported_networks.html">
   Geometry of Imported Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="overview_of_domain_syntax.html">
   OpenPNM Version 3: The new @domain syntax
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="overview_of_shape_factors.html">
   Overview of Shape Factors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="the_problem_with_domain_length_and_area.html">
   Problem with Domain Area and Length
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working_with_extracted_networks.html">
   Working with Extracted Networks
  </a>
 </li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 0;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Tutorial-3---Advanced">
<h1>Tutorial 3 - Advanced<a class="headerlink" href="#Tutorial-3---Advanced" title="Permalink to this headline">#</a></h1>
<section id="Tutorial-3-of-3:-Advanced-Topics-and-Usage">
<h2>Tutorial 3 of 3: Advanced Topics and Usage<a class="headerlink" href="#Tutorial-3-of-3:-Advanced-Topics-and-Usage" title="Permalink to this headline">#</a></h2>
<p><strong>Learning Outcomes</strong></p>
<ul class="simple">
<li><p>Use different methods to add boundary pores to a network</p></li>
<li><p>Manipulate network topology by adding and removing pores and throats</p></li>
<li><p>Explore the ModelsDict design, including copying models between objects, and changing model parameters</p></li>
<li><p>Write a custom pore-scale model and a custom Phase</p></li>
<li><p>Access and manipulate objects associated with the network</p></li>
<li><p>Combine multiple algorithms to predict relative permeability</p></li>
</ul>
</section>
<section id="Build-and-Manipulate-Network-Topology">
<h2>Build and Manipulate Network Topology<a class="headerlink" href="#Build-and-Manipulate-Network-Topology" title="Permalink to this headline">#</a></h2>
<p>For the present tutorial, we’ll keep the topology simple to help keep the focus on other aspects of OpenPNM.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">openpnm</span> <span class="k">as</span> <span class="nn">op</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = [&#39;svg&#39;]
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">Workspace</span><span class="p">()</span>
<span class="n">ws</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;loglevel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pn</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Cubic</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">0.00006</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;net&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Adding-Boundary-Pores">
<h2>Adding Boundary Pores<a class="headerlink" href="#Adding-Boundary-Pores" title="Permalink to this headline">#</a></h2>
<p>When performing transport simulations it is often useful to have ‘boundary’ pores attached to the surface(s) of the network where boundary conditions can be applied. When using the <strong>Cubic</strong> class, two methods are available for doing this: <code class="docutils literal notranslate"><span class="pre">add_boundaries</span></code>, which is specific for the <strong>Cubic</strong> class, and <code class="docutils literal notranslate"><span class="pre">add_boundary_pores</span></code>, which is a generic method that can also be used on other network types and which is inherited from <strong>GenericNetwork</strong>. The first method automatically adds boundaries to
ALL six faces of the network and offsets them from the network by 1/2 of the value provided as the network <code class="docutils literal notranslate"><span class="pre">spacing</span></code>. The second method provides total control over which boundary pores are created and where they are positioned, but requires the user to specify to which pores the boundary pores should be attached to. Let’s explore these two options:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pn</span><span class="o">.</span><span class="n">add_boundary_pores</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Let’s quickly visualize this network with the added boundaries:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">op</span><span class="o">.</span><span class="n">topotools</span><span class="o">.</span><span class="n">plot_connections</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">op</span><span class="o">.</span><span class="n">topotools</span><span class="o">.</span><span class="n">plot_coordinates</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [3], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> fig, ax <span style="color: rgb(98,98,98)">=</span> plt<span style="color: rgb(98,98,98)">.</span>subplots(figsize<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(98,98,98)">5</span>, <span style="color: rgb(98,98,98)">5</span>))
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">op</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">topotools</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">plot_connections</span>(pn, c<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">r</span><span style="color: rgb(175,0,0)">&#39;</span>, ax<span style="color: rgb(98,98,98)">=</span>ax)
<span class="ansi-green-intense-fg ansi-bold">      3</span> op<span style="color: rgb(98,98,98)">.</span>topotools<span style="color: rgb(98,98,98)">.</span>plot_coordinates(pn, c<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">b</span><span style="color: rgb(175,0,0)">&#39;</span>, ax<span style="color: rgb(98,98,98)">=</span>ax)

<span class="ansi-red-fg">AttributeError</span>: module &#39;openpnm.topotools&#39; has no attribute &#39;plot_connections&#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_reference_uncategorized_intro_to_openpnm_advanced_6_1.svg" src="../../../_images/examples_reference_uncategorized_intro_to_openpnm_advanced_6_1.svg" /></div>
</div>
<section id="Adding-and-Removing-Pores-and-Throats">
<h3>Adding and Removing Pores and Throats<a class="headerlink" href="#Adding-and-Removing-Pores-and-Throats" title="Permalink to this headline">#</a></h3>
<p>OpenPNM uses a list-based data storage scheme for all properties, including topological connections. One of the benefits of this approach is that adding and removing pores and throats from the network is essentially as simple as adding or removing rows from the data arrays. The one exception to this ‘simplicity’ is that the <code class="docutils literal notranslate"><span class="pre">'throat.conns'</span></code> array must be treated carefully when trimming pores, so OpenPNM provides the <code class="docutils literal notranslate"><span class="pre">extend</span></code> and <code class="docutils literal notranslate"><span class="pre">trim</span></code> functions for adding and removing, respectively. To
demonstrate, let’s reduce the coordination number of the network to create a more random structure:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">Nt</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span>  <span class="c1"># Create a mask with ~10% of throats labeled True</span>
<span class="n">op</span><span class="o">.</span><span class="n">topotools</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">throats</span><span class="o">=</span><span class="n">Ts</span><span class="p">)</span>  <span class="c1"># Use mask to indicate which throats to trim</span>
</pre></div>
</div>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">trim</span></code> function is called, it automatically checks the health of the network afterwards, so logger messages might appear on the command line if problems were found such as isolated clusters of pores or pores with no throats. This health check is performed by calling the <strong>Network</strong>’s <code class="docutils literal notranslate"><span class="pre">check_network_health</span></code> method which returns a <strong>HealthDict</strong> containing the results of the checks:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">check_network_health</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [5], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> a <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">pn</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">check_network_health</span>()
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(a)

<span class="ansi-red-fg">AttributeError</span>: &#39;Cubic&#39; object has no attribute &#39;check_network_health&#39;
</pre></div></div>
</div>
<p>The <strong>HealthDict</strong> contains several lists including things like duplicate throats and isolated pores, but also a suggestion of which pores to trim to return the network to a healthy state. Also, the <strong>HealthDict</strong> has a <code class="docutils literal notranslate"><span class="pre">health</span></code> attribute that is <code class="docutils literal notranslate"><span class="pre">False</span></code> is any checks fail.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">op</span><span class="o">.</span><span class="n">topotools</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">pores</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;trim_pores&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [6], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> op<span style="color: rgb(98,98,98)">.</span>topotools<span style="color: rgb(98,98,98)">.</span>trim(network<span style="color: rgb(98,98,98)">=</span>pn, pores<span style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">a</span>[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">trim_pores</span><span style="color: rgb(175,0,0)">&#39;</span>])

<span class="ansi-red-fg">NameError</span>: name &#39;a&#39; is not defined
</pre></div></div>
</div>
<p>Let’s take another look at the network to see the trimmed pores and throats:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">op</span><span class="o">.</span><span class="n">topotools</span><span class="o">.</span><span class="n">plot_connections</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">op</span><span class="o">.</span><span class="n">topotools</span><span class="o">.</span><span class="n">plot_coordinates</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [7], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> fig, ax <span style="color: rgb(98,98,98)">=</span> plt<span style="color: rgb(98,98,98)">.</span>subplots(figsize<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(98,98,98)">5</span>, <span style="color: rgb(98,98,98)">5</span>))
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">op</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">topotools</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">plot_connections</span>(pn, c<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">r</span><span style="color: rgb(175,0,0)">&#39;</span>, ax<span style="color: rgb(98,98,98)">=</span>ax)
<span class="ansi-green-intense-fg ansi-bold">      3</span> op<span style="color: rgb(98,98,98)">.</span>topotools<span style="color: rgb(98,98,98)">.</span>plot_coordinates(pn, c<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">b</span><span style="color: rgb(175,0,0)">&#39;</span>, ax<span style="color: rgb(98,98,98)">=</span>ax)

<span class="ansi-red-fg">AttributeError</span>: module &#39;openpnm.topotools&#39; has no attribute &#39;plot_connections&#39;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_reference_uncategorized_intro_to_openpnm_advanced_14_1.svg" src="../../../_images/examples_reference_uncategorized_intro_to_openpnm_advanced_14_1.svg" /></div>
</div>
</section>
</section>
<section id="Define-Geometry-Objects">
<h2>Define Geometry Objects<a class="headerlink" href="#Define-Geometry-Objects" title="Permalink to this headline">#</a></h2>
<p>The boundary pores we’ve added to the network should be treated a little bit differently. Specifically, they should have no volume or length (as they are not physically representative of real pores). To do this, we create two separate <strong>Geometry</strong> objects, one for internal pores and one for the boundaries:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ps</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;*boundary&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;not&#39;</span><span class="p">)</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">throats</span><span class="p">(</span><span class="s1">&#39;*boundary&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;not&#39;</span><span class="p">)</span>
<span class="n">geom</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">SpheresAndCylinders</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">pores</span><span class="o">=</span><span class="n">Ps</span><span class="p">,</span> <span class="n">throats</span><span class="o">=</span><span class="n">Ts</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;intern&#39;</span><span class="p">)</span>
<span class="n">Ps</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;*boundary&#39;</span><span class="p">)</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">throats</span><span class="p">(</span><span class="s1">&#39;*boundary&#39;</span><span class="p">)</span>
<span class="n">boun</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Boundary</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">pores</span><span class="o">=</span><span class="n">Ps</span><span class="p">,</span> <span class="n">throats</span><span class="o">=</span><span class="n">Ts</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;boun&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [8], line 3</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> Ps <span style="color: rgb(98,98,98)">=</span> pn<span style="color: rgb(98,98,98)">.</span>pores(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">*boundary</span><span style="color: rgb(175,0,0)">&#39;</span>, mode<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">not</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> Ts <span style="color: rgb(98,98,98)">=</span> pn<span style="color: rgb(98,98,98)">.</span>throats(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">*boundary</span><span style="color: rgb(175,0,0)">&#39;</span>, mode<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">not</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-fg">----&gt; 3</span> geom <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">op</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">geometry</span><span style="color: rgb(98,98,98)">.</span>SpheresAndCylinders(network<span style="color: rgb(98,98,98)">=</span>pn, pores<span style="color: rgb(98,98,98)">=</span>Ps, throats<span style="color: rgb(98,98,98)">=</span>Ts, name<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">intern</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      4</span> Ps <span style="color: rgb(98,98,98)">=</span> pn<span style="color: rgb(98,98,98)">.</span>pores(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">*boundary</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      5</span> Ts <span style="color: rgb(98,98,98)">=</span> pn<span style="color: rgb(98,98,98)">.</span>throats(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">*boundary</span><span style="color: rgb(175,0,0)">&#39;</span>)

<span class="ansi-red-fg">AttributeError</span>: module &#39;openpnm&#39; has no attribute &#39;geometry&#39;
</pre></div></div>
</div>
<p>The <strong>SpheresAndCylinders</strong> class is preloaded with the pore-scale models to calculate all the necessary size information (pore diameter, pore.volume, throat lengths, throat.diameter, etc). The <strong>Boundary</strong> class is speciall and is only used for the boundary pores. In this class, geometrical properties are set to small fixed values such that they don’t affect the simulation results.</p>
</section>
<section id="Define-Multiple-Phase-Objects">
<h2>Define Multiple Phase Objects<a class="headerlink" href="#Define-Multiple-Phase-Objects" title="Permalink to this headline">#</a></h2>
<p>In order to simulate relative permeability of air through a partially water-filled network, we need to create each <strong>Phase</strong> object. OpenPNM includes pre-defined classes for each of these common fluids:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phases</span><span class="o">.</span><span class="n">Air</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">)</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phases</span><span class="o">.</span><span class="n">Water</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">)</span>
<span class="n">water</span><span class="p">[</span><span class="s1">&#39;throat.contact_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">110</span>
<span class="n">water</span><span class="p">[</span><span class="s1">&#39;throat.surface_tension&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.072</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [9], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> air <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">op</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">phases</span><span style="color: rgb(98,98,98)">.</span>Air(network<span style="color: rgb(98,98,98)">=</span>pn)
<span class="ansi-green-intense-fg ansi-bold">      2</span> water <span style="color: rgb(98,98,98)">=</span> op<span style="color: rgb(98,98,98)">.</span>phases<span style="color: rgb(98,98,98)">.</span>Water(network<span style="color: rgb(98,98,98)">=</span>pn)
<span class="ansi-green-intense-fg ansi-bold">      3</span> water[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">throat.contact_angle</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">110</span>

<span class="ansi-red-fg">AttributeError</span>: module &#39;openpnm&#39; has no attribute &#39;phases&#39;
</pre></div></div>
</div>
<section id="Aside:-Creating-a-Custom-Phase-Class">
<h3>Aside: Creating a Custom Phase Class<a class="headerlink" href="#Aside:-Creating-a-Custom-Phase-Class" title="Permalink to this headline">#</a></h3>
<p>In many cases you will want to create your own fluid, such as an oil or brine, which may be commonly used in your research. OpenPNM cannot predict all the possible scenarios, but luckily it is easy to create a custom <strong>Phase</strong> class as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openpnm.phases</span> <span class="kn">import</span> <span class="n">GenericPhase</span>

<span class="k">class</span> <span class="nc">Oil</span><span class="p">(</span><span class="n">GenericPhase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;pore.viscosity&#39;</span><span class="p">,</span>
                       <span class="n">model</span><span class="o">=</span><span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">polynomial</span><span class="p">,</span>
                       <span class="n">prop</span><span class="o">=</span><span class="s1">&#39;pore.temperature&#39;</span><span class="p">,</span>
                       <span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mf">1.82082e-2</span><span class="p">,</span> <span class="mf">6.51E-04</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.48E-7</span><span class="p">,</span> <span class="mf">1.11E-10</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;pore.molecular_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">116</span>  <span class="c1"># g/mol</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [10], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">openpnm</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">phases</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> GenericPhase
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-bold" style="color: rgb(0,135,0)">class</span> <span class="ansi-bold" style="color: rgb(0,0,255)">Oil</span>(GenericPhase):
<span class="ansi-green-intense-fg ansi-bold">      4</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;openpnm.phases&#39;
</pre></div></div>
</div>
<ul class="simple">
<li><p>Creating a <strong>Phase</strong> class basically involves placing a series of <code class="docutils literal notranslate"><span class="pre">self.add_model</span></code> commands within the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> section of the class definition. This means that when the class is instantiated, all the models are added to <em>itself</em> (i.e. <code class="docutils literal notranslate"><span class="pre">self</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> is a Python trick that captures all arguments in a <em>dict</em> called <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> and passes them to another function that may need them. In this case they are passed to the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method of <strong>Oil</strong>’s parent by the <code class="docutils literal notranslate"><span class="pre">super</span></code> function. Specifically, things like <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">network</span></code> are expected.</p></li>
<li><p>The above code block also stores the molecular weight of the oil as a constant value</p></li>
<li><p>Adding models and constant values in this way could just as easily be done in a run script, but the advantage of defining a class is that it can be saved in a file (i.e. ‘my_custom_phases’) and reused in any project.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oil</span> <span class="o">=</span> <span class="n">Oil</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oil</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [11], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> oil <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">Oil</span>(network<span style="color: rgb(98,98,98)">=</span>pn)
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(oil)

<span class="ansi-red-fg">NameError</span>: name &#39;Oil&#39; is not defined
</pre></div></div>
</div>
</section>
</section>
<section id="Define-Physics-Objects-for-Each-Geometry-and-Each-Phase">
<h2>Define Physics Objects for Each Geometry and Each Phase<a class="headerlink" href="#Define-Physics-Objects-for-Each-Geometry-and-Each-Phase" title="Permalink to this headline">#</a></h2>
<p>In the tutorial #2 we created two <strong>Physics</strong> object, one for each of the two <strong>Geometry</strong> objects used to handle the stratified layers. In this tutorial, the internal pores and the boundary pores each have their own <strong>Geometry</strong>, but there are two <strong>Phases</strong>, which also each require a unique <strong>Physics</strong>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys_water_internal</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">GenericPhysics</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">water</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
<span class="n">phys_air_internal</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">GenericPhysics</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">air</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geom</span><span class="p">)</span>
<span class="n">phys_water_boundary</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">GenericPhysics</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">water</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">boun</span><span class="p">)</span>
<span class="n">phys_air_boundary</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">GenericPhysics</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">air</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">boun</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [12], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> phys_water_internal <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">op</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">physics</span><span style="color: rgb(98,98,98)">.</span>GenericPhysics(network<span style="color: rgb(98,98,98)">=</span>pn, phase<span style="color: rgb(98,98,98)">=</span>water, geometry<span style="color: rgb(98,98,98)">=</span>geom)
<span class="ansi-green-intense-fg ansi-bold">      2</span> phys_air_internal <span style="color: rgb(98,98,98)">=</span> op<span style="color: rgb(98,98,98)">.</span>physics<span style="color: rgb(98,98,98)">.</span>GenericPhysics(network<span style="color: rgb(98,98,98)">=</span>pn, phase<span style="color: rgb(98,98,98)">=</span>air, geometry<span style="color: rgb(98,98,98)">=</span>geom)
<span class="ansi-green-intense-fg ansi-bold">      3</span> phys_water_boundary <span style="color: rgb(98,98,98)">=</span> op<span style="color: rgb(98,98,98)">.</span>physics<span style="color: rgb(98,98,98)">.</span>GenericPhysics(network<span style="color: rgb(98,98,98)">=</span>pn, phase<span style="color: rgb(98,98,98)">=</span>water, geometry<span style="color: rgb(98,98,98)">=</span>boun)

<span class="ansi-red-fg">AttributeError</span>: module &#39;openpnm&#39; has no attribute &#39;physics&#39;
</pre></div></div>
</div>
<blockquote>
<div><p>To reiterate, <em>one</em> <strong>Physics</strong> object is required for each <strong>Geometry</strong> <em>AND</em> each <strong>Phase</strong>, so the number can grow to become annoying very quickly Some useful tips for easing this situation are given below.</p>
</div></blockquote>
<section id="Create-a-Custom-Pore-Scale-Physics-Model">
<h3>Create a Custom Pore-Scale Physics Model<a class="headerlink" href="#Create-a-Custom-Pore-Scale-Physics-Model" title="Permalink to this headline">#</a></h3>
<p>Perhaps the most distinguishing feature between pore-network modeling papers is the pore-scale physics models employed. Accordingly, OpenPNM was designed to allow for easy customization in this regard, so that you can create your own models to augment or replace the ones included in the OpenPNM <em>models</em> libraries. For demonstration, let’s implement the capillary pressure model proposed by <a class="reference external" href="http://dx.doi.org/10.1006/jcis.1994.1402">Mason and Morrow in 1994</a>. They studied the entry pressure of
non-wetting fluid into a throat formed by spheres, and found that the converging-diverging geometry increased the capillary pressure required to penetrate the throat. As a simple approximation they proposed <span class="math notranslate nohighlight">\(P_c = -2 \sigma \cdot cos(2/3 \theta) / R_t\)</span></p>
<p>Pore-scale models are written as basic function definitions:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mason_model</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">diameter</span><span class="o">=</span><span class="s1">&#39;throat.diameter&#39;</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="s1">&#39;throat.contact_angle&#39;</span><span class="p">,</span>
                <span class="n">sigma</span><span class="o">=</span><span class="s1">&#39;throat.surface_tension&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="mf">0.6667</span><span class="p">):</span>
    <span class="n">proj</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">project</span>
    <span class="n">network</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">network</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">find_phase</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    <span class="n">Dt</span> <span class="o">=</span> <span class="n">network</span><span class="p">[</span><span class="n">diameter</span><span class="p">]</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">phase</span><span class="p">[</span><span class="n">theta</span><span class="p">]</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">phase</span><span class="p">[</span><span class="n">sigma</span><span class="p">]</span>
    <span class="n">Pc</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="o">/</span><span class="n">Dt</span>
    <span class="k">return</span> <span class="n">Pc</span><span class="p">[</span><span class="n">phase</span><span class="o">.</span><span class="n">throats</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<p>Let’s examine the components of above code:</p>
<ul class="simple">
<li><p>The function receives a <code class="docutils literal notranslate"><span class="pre">target</span></code> object as an argument. This indicates which object the results will be returned to.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">f</span></code> value is a scale factor that is applied to the contact angle. Mason and Morrow suggested a value of 2/3 as a decent fit to the data, but we’ll make this an adjustable parameter with 2/3 as the default.</p></li>
<li><p>Note the <code class="docutils literal notranslate"><span class="pre">pore.diameter</span></code> is actually a <strong>Geometry</strong> property, but it is retrieved via the network using the data exchange rules outlined in the second tutorial.</p></li>
<li><p>All of the calculations are done for every throat in the network, but this pore-scale model may be assigned to a <code class="docutils literal notranslate"><span class="pre">target</span></code> like a <strong>Physics</strong> object, that is a subset of the full domain. As such, the last line extracts values from the <code class="docutils literal notranslate"><span class="pre">Pc</span></code> array for the location of <code class="docutils literal notranslate"><span class="pre">target</span></code> and returns just the subset.</p></li>
<li><p>The actual values of the contact angle, surface tension, and throat diameter are NOT sent in as numerical arrays, but rather as dictionary keys to the arrays. There is one very important reason for this: if arrays had been sent, then re-running the model would use the same arrays and hence not use any updated values. By having access to dictionary keys, the model actually looks up the current values in each of the arrays whenever it is run.</p></li>
<li><p>It is good practice to include the dictionary keys as arguments, such as <code class="docutils literal notranslate"><span class="pre">sigma</span> <span class="pre">=</span> <span class="pre">'throat.contact_angle'</span></code>. This way the user can control where the contact angle could be stored on the <code class="docutils literal notranslate"><span class="pre">target</span></code> object.</p></li>
</ul>
</section>
<section id="Copy-Models-Between-Physics-Objects">
<h3>Copy Models Between Physics Objects<a class="headerlink" href="#Copy-Models-Between-Physics-Objects" title="Permalink to this headline">#</a></h3>
<p>As mentioned above, the need to specify a separate <strong>Physics</strong> object for each <strong>Geometry</strong> and <strong>Phase</strong> can become tedious. It is possible to <em>copy</em> the pore-scale models assigned to one object onto another object. First, let’s assign the models we need to <code class="docutils literal notranslate"><span class="pre">phys_water_internal</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">hydraulic_conductance</span><span class="o">.</span><span class="n">hagen_poiseuille</span>
<span class="n">phys_water_internal</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.hydraulic_conductance&#39;</span><span class="p">,</span>
                              <span class="n">model</span><span class="o">=</span><span class="n">mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [14], line 2</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> mod <span style="color: rgb(98,98,98)">=</span> op<span style="color: rgb(98,98,98)">.</span>models<span style="color: rgb(98,98,98)">.</span>physics<span style="color: rgb(98,98,98)">.</span>hydraulic_conductance<span style="color: rgb(98,98,98)">.</span>hagen_poiseuille
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">phys_water_internal</span><span style="color: rgb(98,98,98)">.</span>add_model(propname<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">throat.hydraulic_conductance</span><span style="color: rgb(175,0,0)">&#39;</span>,
<span class="ansi-green-intense-fg ansi-bold">      3</span>                               model<span style="color: rgb(98,98,98)">=</span>mod)

<span class="ansi-red-fg">NameError</span>: name &#39;phys_water_internal&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys_water_internal</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">,</span>
                              <span class="n">model</span><span class="o">=</span><span class="n">mason_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [15], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">phys_water_internal</span><span style="color: rgb(98,98,98)">.</span>add_model(propname<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">throat.entry_pressure</span><span style="color: rgb(175,0,0)">&#39;</span>,
<span class="ansi-green-intense-fg ansi-bold">      2</span>                               model<span style="color: rgb(98,98,98)">=</span>mason_model)

<span class="ansi-red-fg">NameError</span>: name &#39;phys_water_internal&#39; is not defined
</pre></div></div>
</div>
<p>Now make a copy of the <code class="docutils literal notranslate"><span class="pre">models</span></code> on <code class="docutils literal notranslate"><span class="pre">phys_water_internal</span></code> and apply it all the other water <strong>Physics</strong> objects:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys_water_boundary</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">phys_water_internal</span><span class="o">.</span><span class="n">models</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [16], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> phys_water_boundary<span style="color: rgb(98,98,98)">.</span>models <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">phys_water_internal</span><span style="color: rgb(98,98,98)">.</span>models

<span class="ansi-red-fg">NameError</span>: name &#39;phys_water_internal&#39; is not defined
</pre></div></div>
</div>
<p>The only ‘gotcha’ with this approach is that each of the <strong>Physics</strong> objects must be <em>regenerated</em> in order to place numerical values for all the properties into the data arrays:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys_water_boundary</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
<span class="n">phys_air_internal</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
<span class="n">phys_air_internal</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [17], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">phys_water_boundary</span><span style="color: rgb(98,98,98)">.</span>regenerate_models()
<span class="ansi-green-intense-fg ansi-bold">      2</span> phys_air_internal<span style="color: rgb(98,98,98)">.</span>regenerate_models()
<span class="ansi-green-intense-fg ansi-bold">      3</span> phys_air_internal<span style="color: rgb(98,98,98)">.</span>regenerate_models()

<span class="ansi-red-fg">NameError</span>: name &#39;phys_water_boundary&#39; is not defined
</pre></div></div>
</div>
</section>
<section id="Adjust-Pore-Scale-Model-Parameters">
<h3>Adjust Pore-Scale Model Parameters<a class="headerlink" href="#Adjust-Pore-Scale-Model-Parameters" title="Permalink to this headline">#</a></h3>
<p>The pore-scale models are stored in a <strong>ModelsDict</strong> object that is itself stored under the <code class="docutils literal notranslate"><span class="pre">models</span></code> attribute of each object. This arrangement is somewhat convoluted, but it enables integrated storage of models on the object’s wo which they apply. The models on an object can be inspected with <code class="docutils literal notranslate"><span class="pre">print(phys_water_internal)</span></code>, which shows a list of all the pore-scale properties that are computed by a model, and some information about the model’s <em>regeneration</em> mode.</p>
<p>Each model in the <strong>ModelsDict</strong> can be individually inspected by accessing it using the dictionary key corresponding to <em>pore-property</em> that it calculates, i.e. <code class="docutils literal notranslate"><span class="pre">print(phys_water_internal)['throat.capillary_pressure'])</span></code>. This shows a list of all the parameters associated with that model. It is possible to edit these parameters directly:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys_water_internal</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">][</span><span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.75</span>  <span class="c1"># Change value</span>
<span class="n">phys_water_internal</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>  <span class="c1"># Regenerate model with new &#39;f&#39; value</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [18], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">phys_water_internal</span><span style="color: rgb(98,98,98)">.</span>models[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">throat.entry_pressure</span><span style="color: rgb(175,0,0)">&#39;</span>][<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">0.75</span>  <span style="color: rgb(95,135,135)"># Change value</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> phys_water_internal<span style="color: rgb(98,98,98)">.</span>regenerate_models()

<span class="ansi-red-fg">NameError</span>: name &#39;phys_water_internal&#39; is not defined
</pre></div></div>
</div>
<p>More details about the <strong>ModelsDict</strong> and <strong>ModelWrapper</strong> classes can be found in :ref:<code class="docutils literal notranslate"><span class="pre">models</span></code>.</p>
</section>
</section>
<section id="Perform-Multiphase-Transport-Simulations">
<h2>Perform Multiphase Transport Simulations<a class="headerlink" href="#Perform-Multiphase-Transport-Simulations" title="Permalink to this headline">#</a></h2>
<section id="Use-the-Built-In-Drainage-Algorithm-to-Generate-an-Invading-Phase-Configuration">
<h3>Use the Built-In Drainage Algorithm to Generate an Invading Phase Configuration<a class="headerlink" href="#Use-the-Built-In-Drainage-Algorithm-to-Generate-an-Invading-Phase-Configuration" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inv</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">Porosimetry</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">water</span><span class="p">)</span>
<span class="n">inv</span><span class="o">.</span><span class="n">set_inlets</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">([</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]))</span>
<span class="n">inv</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [19], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> inv <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">op</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">algorithms</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">Porosimetry</span>(network<span style="color: rgb(98,98,98)">=</span>pn, phase<span style="color: rgb(98,98,98)">=</span>water)
<span class="ansi-green-intense-fg ansi-bold">      2</span> inv<span style="color: rgb(98,98,98)">.</span>set_inlets(pores<span style="color: rgb(98,98,98)">=</span>pn<span style="color: rgb(98,98,98)">.</span>pores([<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">top</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">bottom</span><span style="color: rgb(175,0,0)">&#39;</span>]))
<span class="ansi-green-intense-fg ansi-bold">      3</span> inv<span style="color: rgb(98,98,98)">.</span>run()

<span class="ansi-red-fg">AttributeError</span>: module &#39;openpnm.algorithms&#39; has no attribute &#39;Porosimetry&#39;
</pre></div></div>
</div>
<ul class="simple">
<li><p>The inlet pores were set to both <code class="docutils literal notranslate"><span class="pre">'top'</span></code> and <code class="docutils literal notranslate"><span class="pre">'bottom'</span></code> using the <code class="docutils literal notranslate"><span class="pre">pn.pores</span></code> method. The algorithm applies to the entire network so the mapping of network pores to the algorithm pores is 1-to-1.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">run</span></code> method automatically generates a list of 25 capillary pressure points to test, but you can also specify more pores, or which specific points to tests. See the methods documentation for the details.</p></li>
<li><p>Once the algorithm has been run, the resulting capillary pressure curve can be viewed with <code class="docutils literal notranslate"><span class="pre">plot_drainage_curve</span></code>. If you’d prefer a table of data for plotting in your software of choice you can use <code class="docutils literal notranslate"><span class="pre">get_drainage_data</span></code> which prints a table in the console.</p></li>
</ul>
</section>
<section id="Set-Pores-and-Throats-to-Invaded">
<h3>Set Pores and Throats to Invaded<a class="headerlink" href="#Set-Pores-and-Throats-to-Invaded" title="Permalink to this headline">#</a></h3>
<p>After running, the <code class="docutils literal notranslate"><span class="pre">mip</span></code> object possesses an array containing the pressure at which each pore and throat was invaded, stored as <code class="docutils literal notranslate"><span class="pre">'pore.inv_Pc'</span></code> and <code class="docutils literal notranslate"><span class="pre">'throat.inv_Pc'</span></code>. These arrays can be used to obtain a list of which pores and throats are invaded by water, using Boolean logic:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Pi</span> <span class="o">=</span> <span class="n">inv</span><span class="p">[</span><span class="s1">&#39;pore.invasion_pressure&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5000</span>
<span class="n">Ti</span> <span class="o">=</span> <span class="n">inv</span><span class="p">[</span><span class="s1">&#39;throat.invasion_pressure&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5000</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [20], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> Pi <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">inv</span>[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">pore.invasion_pressure</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">&lt;</span> <span style="color: rgb(98,98,98)">5000</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> Ti <span style="color: rgb(98,98,98)">=</span> inv[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">throat.invasion_pressure</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">&lt;</span> <span style="color: rgb(98,98,98)">5000</span>

<span class="ansi-red-fg">NameError</span>: name &#39;inv&#39; is not defined
</pre></div></div>
</div>
<p>The resulting Boolean masks can be used to manually adjust the hydraulic conductivity of pores and throats based on their phase occupancy. The following lines set the water filled throats to near-zero conductivity for air flow:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ts</span> <span class="o">=</span> <span class="n">phys_water_internal</span><span class="o">.</span><span class="n">map_throats</span><span class="p">(</span><span class="o">~</span><span class="n">Ti</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">water</span><span class="p">)</span>
<span class="n">phys_water_internal</span><span class="p">[</span><span class="s1">&#39;throat.hydraulic_conductance&#39;</span><span class="p">][</span><span class="n">Ts</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-20</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [21], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> Ts <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">phys_water_internal</span><span style="color: rgb(98,98,98)">.</span>map_throats(<span style="color: rgb(98,98,98)">~</span>Ti, origin<span style="color: rgb(98,98,98)">=</span>water)
<span class="ansi-green-intense-fg ansi-bold">      2</span> phys_water_internal[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">throat.hydraulic_conductance</span><span style="color: rgb(175,0,0)">&#39;</span>][Ts] <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">1e-20</span>

<span class="ansi-red-fg">NameError</span>: name &#39;phys_water_internal&#39; is not defined
</pre></div></div>
</div>
<ul class="simple">
<li><p>The logic of these statements implicitly assumes that transport between two pores is only blocked if the throat is filled with the other phase, meaning that both pores could be filled and transport is still permitted. Another option would be to set the transport to near-zero if <em>either</em> or <em>both</em> of the pores are filled as well.</p></li>
<li><p>The above approach can get complicated if there are several <strong>Geometry</strong> objects, and it is also a bit laborious. There is a pore-scale model for this under <strong>Physics.models.multiphase</strong> called <code class="docutils literal notranslate"><span class="pre">conduit_conductance</span></code>. The term conduit refers to the path between two pores that includes 1/2 of each pores plus the connecting throat.</p></li>
</ul>
</section>
<section id="Calculate-Relative-Permeability-of-Each-Phase">
<h3>Calculate Relative Permeability of Each Phase<a class="headerlink" href="#Calculate-Relative-Permeability-of-Each-Phase" title="Permalink to this headline">#</a></h3>
<p>We are now ready to calculate the relative permeability of the domain under partially flooded conditions. Instantiate an <strong>StokesFlow</strong> object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water_flow</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">StokesFlow</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">water</span><span class="p">)</span>
<span class="n">water_flow</span><span class="o">.</span><span class="n">set_value_BC</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="mi">200000</span><span class="p">)</span>
<span class="n">water_flow</span><span class="o">.</span><span class="n">set_value_BC</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">water_flow</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Q_partial</span><span class="p">,</span> <span class="o">=</span> <span class="n">water_flow</span><span class="o">.</span><span class="n">rate</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [22], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> water_flow <span style="color: rgb(98,98,98)">=</span> op<span style="color: rgb(98,98,98)">.</span>algorithms<span style="color: rgb(98,98,98)">.</span>StokesFlow(network<span style="color: rgb(98,98,98)">=</span>pn, phase<span style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">water</span>)
<span class="ansi-green-intense-fg ansi-bold">      2</span> water_flow<span style="color: rgb(98,98,98)">.</span>set_value_BC(pores<span style="color: rgb(98,98,98)">=</span>pn<span style="color: rgb(98,98,98)">.</span>pores(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">left</span><span style="color: rgb(175,0,0)">&#39;</span>), values<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">200000</span>)
<span class="ansi-green-intense-fg ansi-bold">      3</span> water_flow<span style="color: rgb(98,98,98)">.</span>set_value_BC(pores<span style="color: rgb(98,98,98)">=</span>pn<span style="color: rgb(98,98,98)">.</span>pores(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">right</span><span style="color: rgb(175,0,0)">&#39;</span>), values<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">100000</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;water&#39; is not defined
</pre></div></div>
</div>
<p>The <em>relative</em> permeability is the ratio of the water flow through the partially water saturated media versus through fully water saturated media; hence we need to find the absolute permeability of water. This can be accomplished by <em>regenerating</em> the <code class="docutils literal notranslate"><span class="pre">phys_water_internal</span></code> object, which will recalculate the <code class="docutils literal notranslate"><span class="pre">'throat.hydraulic_conductance'</span></code> values and overwrite our manually entered near-zero values from the <code class="docutils literal notranslate"><span class="pre">inv</span></code> simulation using <code class="docutils literal notranslate"><span class="pre">phys_water_internal.models.regenerate()</span></code>. We can then
re-use the <code class="docutils literal notranslate"><span class="pre">water_flow</span></code> algorithm:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys_water_internal</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
<span class="n">water_flow</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Q_full</span><span class="p">,</span> <span class="o">=</span> <span class="n">water_flow</span><span class="o">.</span><span class="n">rate</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [23], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">phys_water_internal</span><span style="color: rgb(98,98,98)">.</span>regenerate_models()
<span class="ansi-green-intense-fg ansi-bold">      2</span> water_flow<span style="color: rgb(98,98,98)">.</span>run()
<span class="ansi-green-intense-fg ansi-bold">      3</span> Q_full, <span style="color: rgb(98,98,98)">=</span> water_flow<span style="color: rgb(98,98,98)">.</span>rate(pores<span style="color: rgb(98,98,98)">=</span>pn<span style="color: rgb(98,98,98)">.</span>pores(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">right</span><span style="color: rgb(175,0,0)">&#39;</span>))

<span class="ansi-red-fg">NameError</span>: name &#39;phys_water_internal&#39; is not defined
</pre></div></div>
</div>
<p>And finally, the relative permeability can be found from:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K_rel</span> <span class="o">=</span> <span class="n">Q_partial</span><span class="o">/</span><span class="n">Q_full</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relative permeability: </span><span class="si">{</span><span class="n">K_rel</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In [24], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> K_rel <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">Q_partial</span><span style="color: rgb(98,98,98)">/</span>Q_full
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span style="color: rgb(0,135,0)">print</span>(<span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">Relative permeability: </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>K_rel<span class="ansi-bold" style="color: rgb(175,95,135)">:</span><span style="color: rgb(175,0,0)">.5f</span><span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">&#34;</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;Q_partial&#39; is not defined
</pre></div></div>
</div>
<p>Notes: * The ratio of the flow rates gives the normalized relative permeability since all the domain size, viscosity and pressure differential terms cancel each other. * To generate a full relative permeability curve the above logic would be placed inside a for loop, with each loop increasing the pressure threshold used to obtain the list of invaded throats (<code class="docutils literal notranslate"><span class="pre">Ti</span></code>). * The saturation at each capillary pressure can be found be summing the pore and throat volume of all the invaded pores and
throats using <code class="docutils literal notranslate"><span class="pre">Vp</span> <span class="pre">=</span> <span class="pre">geom['pore.volume'][Pi]</span></code> and <code class="docutils literal notranslate"><span class="pre">Vt</span> <span class="pre">=</span> <span class="pre">geom['throat.volume'][Ti]</span></code>.</p>
</section>
</section>
</section>


            </article>
            
            
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fas fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Tutorial-3-of-3:-Advanced-Topics-and-Usage">
   Tutorial 3 of 3: Advanced Topics and Usage
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Build-and-Manipulate-Network-Topology">
   Build and Manipulate Network Topology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Adding-Boundary-Pores">
   Adding Boundary Pores
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Adding-and-Removing-Pores-and-Throats">
     Adding and Removing Pores and Throats
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Define-Geometry-Objects">
   Define Geometry Objects
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Define-Multiple-Phase-Objects">
   Define Multiple Phase Objects
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Aside:-Creating-a-Custom-Phase-Class">
     Aside: Creating a Custom Phase Class
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Define-Physics-Objects-for-Each-Geometry-and-Each-Phase">
   Define Physics Objects for Each Geometry and Each Phase
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Create-a-Custom-Pore-Scale-Physics-Model">
     Create a Custom Pore-Scale Physics Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Copy-Models-Between-Physics-Objects">
     Copy Models Between Physics Objects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Adjust-Pore-Scale-Model-Parameters">
     Adjust Pore-Scale Model Parameters
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Perform-Multiphase-Transport-Simulations">
   Perform Multiphase Transport Simulations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Use-the-Built-In-Drainage-Algorithm-to-Generate-an-Invading-Phase-Configuration">
     Use the Built-In Drainage Algorithm to Generate an Invading Phase Configuration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Set-Pores-and-Throats-to-Invaded">
     Set Pores and Throats to Invaded
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Calculate-Relative-Permeability-of-Each-Phase">
     Calculate Relative Permeability of Each Phase
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, PMEAL.<br>

</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
  </footer>
  </body>
</html>