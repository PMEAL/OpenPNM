
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Transient Fickian Diffusion &#8212; OpenPNM 2.8.2.dev111140 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/custom.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/openpnm_logo.jpg" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/openpnm_logo.jpg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../basic_usage.html">
  Basic Usage
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../modules/index.html">
  Module Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../_examples/index.html">
  Examples
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/issues">Issue Tracker<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/discussions">Get Help<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PMEAL/OpenPNM" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fetch-the-global-workspace">
   Fetch the global workspace
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generate-a-pore-network">
   Generate a pore network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-geometrical-properties">
   Add geometrical properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-a-phase">
   Add a phase
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-geometry-based-thermophysical-properties">
   Add geometry-based thermophysical properties
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-a-transient-fickian-diffusion-algorithm">
   Define a transient Fickian diffusion algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-boundary-conditions">
   Add boundary conditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-initial-conditions">
   Define initial conditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-the-transient-algorithm-settings">
   Setup the transient algorithm settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#print-the-algorithm-settings">
   Print the algorithm settings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-algorithm">
   Run the algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-process-and-export-the-results">
   Post process and export the results
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visialization-using-matplotlib">
   Visialization using Matplotlib
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section class="tex2jax_ignore mathjax_ignore" id="transient-fickian-diffusion">
<h1>Transient Fickian Diffusion<a class="headerlink" href="#transient-fickian-diffusion" title="Permalink to this heading">#</a></h1>
<p>The package <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> allows for the simulation of many transport phenomena in porous media such as Stokes flow, Fickian diffusion, advection-diffusion, transport of charged species, etc. Transient and steady-state simulations are both supported. An example of a transient Fickian diffusion simulation through a <code class="docutils literal notranslate"><span class="pre">Cubic</span></code> pore network is shown here.</p>
<p>First, <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> is imported.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openpnm</span> <span class="k">as</span> <span class="nn">op</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = [&#39;svg&#39;]
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="fetch-the-global-workspace">
<h2>Fetch the global workspace<a class="headerlink" href="#fetch-the-global-workspace" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Workspace</span></code> is <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code>’s global object manager. In simple terms, every object that you create (ex. networks, phases, and algorithms) can be ultimately found by inspecting the <code class="docutils literal notranslate"><span class="pre">Workspace</span></code>. Note that the <code class="docutils literal notranslate"><span class="pre">Workspace</span></code> object is a singleton, meaning that no matter how many times you instantiate it, you’ll get one and only one instance back.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">Workspace</span><span class="p">()</span>
<span class="n">ws</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;loglevel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="generate-a-pore-network">
<h2>Generate a pore network<a class="headerlink" href="#generate-a-pore-network" title="Permalink to this heading">#</a></h2>
<p>An arbitrary <code class="docutils literal notranslate"><span class="pre">Cubic</span></code> 3D pore network is generated consisting of a layer of <span class="math notranslate nohighlight">\(29\times13\)</span> pores with a constant pore to pore centers spacing of <span class="math notranslate nohighlight">\({10}^{-4}{m}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Cubic</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-geometrical-properties">
<h2>Add geometrical properties<a class="headerlink" href="#add-geometrical-properties" title="Permalink to this heading">#</a></h2>
<p>Initially, the <code class="docutils literal notranslate"><span class="pre">Cubic</span></code> class mostly has topological information plus the pore coordinates, and geometrical information such as pore diameter, throat diameter, etc. still needs to be added. <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> has a rich library of models that add such information to your network, which are located under the <code class="docutils literal notranslate"><span class="pre">opepnm.models</span></code> module. Since you need to manually add many of these models for your simulation to work, <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> provides “model collections”, which can be added to your network in one shot. A model collection is a bundle of compatible models that together approximate a specific geometry, for instance <code class="docutils literal notranslate"><span class="pre">spheres_and_cylinders</span></code>, which assumes your pores are ideal spheres and the connecting throats are ideal cylinders. Model collections are located under <code class="docutils literal notranslate"><span class="pre">openpnm.collections</span></code>. Note that it’s good practice to regenerate the models after you add a model collection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mods</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">spheres_and_cylinders</span><span class="p">()</span>
<span class="n">net</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">mods</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mods</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">spheres_and_cylinders</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">net</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">mods</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">net</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>

<span class="ne">TypeError</span>: &#39;dict&#39; object is not callable
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-a-phase">
<h2>Add a phase<a class="headerlink" href="#add-a-phase" title="Permalink to this heading">#</a></h2>
<p>Then, a phase (water in this example) is added to the simulation and assigned to the network. The phase contains the physical properties of the fluid considered in the simulation such as the viscosity, etc. Many predefined phases as available on <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">Water</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-geometry-based-thermophysical-properties">
<h2>Add geometry-based thermophysical properties<a class="headerlink" href="#add-geometry-based-thermophysical-properties" title="Permalink to this heading">#</a></h2>
<p>Like <code class="docutils literal notranslate"><span class="pre">Cubic</span></code>, initially the <code class="docutils literal notranslate"><span class="pre">Water</span></code> class only contains thermophysical properties, such as viscosity, molecular weight, etc. However, for your simulations to work, you need another set of properties such as diffusive conductance (to perform diffusion simulations), hydraulic conductance (to perform fluid flow simulations), etc. These properties, which we call geometry-based thermophysical properties, depend on both thermophysical and geometrical features. <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> has lots of built-in geometry-based thermophysical properties, which are located under <code class="docutils literal notranslate"><span class="pre">openpnm.models.physics</span></code>. Similar to geometrical properties, <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> provides various “model collections”, which can be added to your <code class="docutils literal notranslate"><span class="pre">Phase</span></code> object in one shot, rather than adding different models one by one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mods</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">basic</span><span class="p">()</span>
<span class="n">water</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">mods</span><span class="p">)</span>
<span class="n">water</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-a-transient-fickian-diffusion-algorithm">
<h2>Define a transient Fickian diffusion algorithm<a class="headerlink" href="#define-a-transient-fickian-diffusion-algorithm" title="Permalink to this heading">#</a></h2>
<p>Here, an algorithm for the simulation of transient Fickian diffusion is defined. It is assigned to the network and phase of interest to be able to retrieve all the information needed to build systems of linear equations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tfd</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">TransientFickianDiffusion</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">water</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-boundary-conditions">
<h2>Add boundary conditions<a class="headerlink" href="#add-boundary-conditions" title="Permalink to this heading">#</a></h2>
<p>Next, Dirichlet boundary conditions are added over the back and front boundaries of the network.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tfd</span><span class="o">.</span><span class="n">set_value_BC</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;back&#39;</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">tfd</span><span class="o">.</span><span class="n">set_value_BC</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;front&#39;</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-initial-conditions">
<h2>Define initial conditions<a class="headerlink" href="#define-initial-conditions" title="Permalink to this heading">#</a></h2>
<p>Initial conditions must be specified when <code class="docutils literal notranslate"><span class="pre">alg.run</span></code> is called as <code class="docutils literal notranslate"><span class="pre">alg.run(x0=x0)</span></code>, where <code class="docutils literal notranslate"><span class="pre">x0</span></code> could either be a scalar (in which case it’ll be broadcasted to all pores), or an array.</p>
</section>
<section id="setup-the-transient-algorithm-settings">
<h2>Setup the transient algorithm settings<a class="headerlink" href="#setup-the-transient-algorithm-settings" title="Permalink to this heading">#</a></h2>
<p>The settings of the transient algorithm are updated here. When calling <code class="docutils literal notranslate"><span class="pre">alg.run</span></code>, you can pass the following arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x0</span></code>: initial conditions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tspan</span></code>: integration time span</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">saveat</span></code>: the interval at which the solution is to be stored</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">saveat</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="print-the-algorithm-settings">
<h2>Print the algorithm settings<a class="headerlink" href="#print-the-algorithm-settings" title="Permalink to this heading">#</a></h2>
<p>One can print the algorithm’s settings as shown here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tfd</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Settings                            Values
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
uuid                                41cd2a5e-02b4-4118-8d11-ae83183ec0a9
cache                               True
conductance                         throat.diffusive_conductance
phase                               phase_01
quantity                            pore.concentration
variable_props                      TypedSet()
f_rtol                              1e-06
newton_maxiter                      5000
relaxation_factor                   1.0
x_rtol                              1e-06
pore_volume                         pore.volume
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</pre></div>
</div>
</div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">quantity</span></code> corresponds to the quantity solved for.</p>
</section>
<section id="run-the-algorithm">
<h2>Run the algorithm<a class="headerlink" href="#run-the-algorithm" title="Permalink to this heading">#</a></h2>
<p>The algorithm is run here. Algorithms usually return the solution object, which is basically a dictionary containing the solution as a numpy array which can be accessed via the key <code class="docutils literal notranslate"><span class="pre">alg.settings.quantity</span></code>. In addition, the solution object is stored on the algorithm itself, so you can access it via <code class="docutils literal notranslate"><span class="pre">alg.soln</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">soln</span> <span class="o">=</span> <span class="n">tfd</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">tspan</span><span class="o">=</span><span class="n">tspan</span><span class="p">,</span> <span class="n">saveat</span><span class="o">=</span><span class="n">saveat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="post-process-and-export-the-results">
<h2>Post process and export the results<a class="headerlink" href="#post-process-and-export-the-results" title="Permalink to this heading">#</a></h2>
<p>Once the simulation is successfully performed. The solution at every time steps is stored within the algorithm object. The algorithm’s stored information is printed here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tfd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
openpnm.algorithms.TransientFickianDiffusion : trans_fick_01
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
#     Properties                                    Valid Values
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
1     pore.bc.rate                                      0 / 377  
2     pore.bc.value                                    26 / 377  
3     pore.concentration                              377 / 377  
4     pore.ic                                         377 / 377  
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
#     Labels                                        Assigned Locations
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
1     pore.all                                      377       
2     pore.trans_fick_01                            377       
3     throat.all                                    712       
4     throat.trans_fick_01                          712       
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</pre></div>
</div>
</div>
</div>
<p>Note that the solution object contains the solution as a numpy array with the shape <code class="docutils literal notranslate"><span class="pre">[Np,</span> <span class="pre">nt]</span></code>, where <code class="docutils literal notranslate"><span class="pre">Np</span></code> and <code class="docutils literal notranslate"><span class="pre">nt</span></code> are the number of pores and exported time steps, respectively. For convenience, we’ve added some extra functionality to the numpy array, most notable of which is interpolation. So, if you want to interpolate the solution at some intermediate time point, you can just “call” the numpy array at that particular time point.</p>
<p>Let’s take a look at the solution object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">soln</span><span class="p">[</span><span class="s2">&quot;pore.concentration&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">soln</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;pore.concentration&#39;: TransientSolution([[0.2    , 0.2    , 0.2    , ..., 0.2    , 0.2    ,
                    0.2    ],
                   [0.2    , 0.2    , 0.2    , ..., 0.2    , 0.2    ,
                    0.2    ],
                   [0.2    , 0.2    , 0.2    , ..., 0.2    , 0.2    ,
                    0.2    ],
                   ...,
                   [0.2    , 0.22296, 0.2528 , ..., 0.3612 , 0.36362,
                    0.36595],
                   [0.2    , 0.30164, 0.35183, ..., 0.43861, 0.43974,
                    0.44082],
                   [0.5    , 0.5    , 0.5    , ..., 0.5    , 0.5    ,
                    0.5    ]])}
</pre></div>
</div>
</div>
</div>
<p>To see which time points have been exported in the solution, object you can just look at its property <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransientSolution([  0,   5,  10,  15,  20,  25,  30,  35,  40,  45,  50,
                    55,  60,  65,  70,  75,  80,  85,  90,  95, 100])
</pre></div>
</div>
</div>
</div>
<p>Now, let’s interpolate the solution at some intermediate time point, <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">7.34</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">(</span><span class="mf">7.34</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.20001, 0.20003, 0.20017, 0.20151, 0.20712, 0.22662, 0.30658,
       0.5    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.20002, 0.20008, 0.20143, 0.20634, 0.21905,
       0.26123, 0.5    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.20002, 0.20012, 0.20064, 0.20532,
       0.22082, 0.317  , 0.5    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.20001, 0.20014, 0.20073,
       0.20299, 0.22838, 0.32654, 0.5    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.20002, 0.20009,
       0.20088, 0.20428, 0.22645, 0.29008, 0.5    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.20002,
       0.20011, 0.20099, 0.205  , 0.22151, 0.30376, 0.5    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.20001, 0.20006, 0.20071, 0.20669, 0.2217 , 0.27469, 0.5    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.20001, 0.20011, 0.20041, 0.20511, 0.21849, 0.3047 ,
       0.5    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.20001, 0.20013, 0.20072, 0.20341, 0.21363,
       0.26103, 0.5    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.20007, 0.20036, 0.20125,
       0.22176, 0.28085, 0.5    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2001 , 0.20035,
       0.20165, 0.21302, 0.31313, 0.5    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.20001, 0.20012,
       0.20049, 0.20499, 0.22185, 0.29491, 0.5    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    ,
       0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.2    , 0.20004,
       0.20022, 0.20139, 0.20725, 0.23693, 0.32513, 0.5    ])
</pre></div>
</div>
</div>
</div>
</section>
<section id="visialization-using-matplotlib">
<h2>Visialization using Matplotlib<a class="headerlink" href="#visialization-using-matplotlib" title="Permalink to this heading">#</a></h2>
<p>One can perform post processing and visualization using the exported files on an external software such as <code class="docutils literal notranslate"><span class="pre">Paraview</span></code>. Additionally, the <code class="docutils literal notranslate"><span class="pre">Python</span></code> library <code class="docutils literal notranslate"><span class="pre">Matplotlib</span></code> can be used as shown here to plot the concentration color map at steady-state. We now plot the solution at two different time points, 25.5 s and 95.5 s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>

<span class="c1"># Plot c(x,y) @ t=25.5 and t=95.5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mf">25.5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;concentration (mol/m$^3$) @ t = 25.5 s&#39;</span><span class="p">)</span>
<span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;4%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mf">95.5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;concentration (mol/m$^3$) @ t = 95.5 s&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fbcdae5f0eebe52b37374c141310fce280e2a7c16fd6be381b514e5a2582df65.svg" src="../../_images/fbcdae5f0eebe52b37374c141310fce280e2a7c16fd6be381b514e5a2582df65.svg" /></div>
</div>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PMEAL.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>