
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Meniscus Model Comparison &#8212; OpenPNM 2.8.2.dev111141 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"0371c7be98f3445087ccbcf19a84cb93": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_149d9fdf609742639261464d97377f2a", "msg_id": "", "outputs": [{"data": {"text/plain": "<AxesSubplot:>"}, "metadata": {}, "output_type": "display_data"}]}}, "039f211a098744379f96eaa7bef4c68c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_56b49be978034ce696a77c6f36b51850", "IPY_MODEL_0371c7be98f3445087ccbcf19a84cb93"], "layout": "IPY_MODEL_81a7f98a959743ef9aeb54a807c2bab1"}}, "0a4d77f03b1248a088e16131636d7ca4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "SliderStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "0ad7d61e83724c92aa16745e3324a924": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "11b62560f2164d079f48875cb3818b3d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatSliderModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "FloatSliderView", "continuous_update": true, "description": "target_Pc", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_49f05332d50e47f8868b75e7405a362b", "max": 8165.324889242946, "min": -2000, "orientation": "horizontal", "readout": true, "readout_format": ".2f", "step": 1, "style": "IPY_MODEL_62f3f2a2ac5c467b8545bab0aea08d31", "value": 3082}}, "11c62a1c37424b19830423996db771e1": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "149d9fdf609742639261464d97377f2a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "19037a073aab4d87a1144bb8e891938c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_11b62560f2164d079f48875cb3818b3d", "IPY_MODEL_a3c1652ec47043d0a337954a943fd77b"], "layout": "IPY_MODEL_8cca0fc765c140798ee259e6cd1ba164"}}, "40e6d9c10c3849a0894948448cf09741": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatSliderModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "FloatSliderView", "continuous_update": true, "description": "target_Pc", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_11c62a1c37424b19830423996db771e1", "max": 8165.324889242946, "min": -2000, "orientation": "horizontal", "readout": true, "readout_format": ".2f", "step": 1, "style": "IPY_MODEL_0a4d77f03b1248a088e16131636d7ca4", "value": 3082}}, "49f05332d50e47f8868b75e7405a362b": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "50279e9d0f76465d852c669e063ce00e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "SliderStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "56b49be978034ce696a77c6f36b51850": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "FloatSliderModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "FloatSliderView", "continuous_update": true, "description": "target_Pc", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a0807a4817be455c9878e2a3c7f696fb", "max": 4729.770413396985, "min": -2000, "orientation": "horizontal", "readout": true, "readout_format": ".2f", "step": 1, "style": "IPY_MODEL_50279e9d0f76465d852c669e063ce00e", "value": 1364}}, "5aec01137eee4af6911347ed18090eba": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_40e6d9c10c3849a0894948448cf09741", "IPY_MODEL_c1f7661b0b05448eab5a64318a884f81"], "layout": "IPY_MODEL_b10e5a52a15d4865bb5a36e19ccfe56d"}}, "62f3f2a2ac5c467b8545bab0aea08d31": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "model_name": "SliderStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "81a7f98a959743ef9aeb54a807c2bab1": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8cca0fc765c140798ee259e6cd1ba164": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a0807a4817be455c9878e2a3c7f696fb": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a3c1652ec47043d0a337954a943fd77b": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_0ad7d61e83724c92aa16745e3324a924", "msg_id": "", "outputs": [{"data": {"text/plain": "<AxesSubplot:>"}, "metadata": {}, "output_type": "display_data"}]}}, "b10e5a52a15d4865bb5a36e19ccfe56d": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c1f7661b0b05448eab5a64318a884f81": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ce9cbca437bf49f7bddc6c38e4917f95", "msg_id": "", "outputs": [{"data": {"text/plain": "<AxesSubplot:>"}, "metadata": {}, "output_type": "display_data"}]}}, "ce9cbca437bf49f7bddc6c38e4917f95": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../../_static/js/custom.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/openpnm_logo.jpg" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/openpnm_logo.jpg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../basic_usage.html">
  Basic Usage
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../modules/index.html">
  Module Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../_examples/index.html">
  Examples
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/issues">Issue Tracker<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/discussions">Get Help<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PMEAL/OpenPNM" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comparison-of-toroidal-meniscus-models-with-different-profile-shapes">
   Comparison of toroidal meniscus models with different profile shapes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-up">
   Set up
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#circular-purcell">
   Circular (Purcell)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sinusoidal">
   Sinusoidal
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-elliptical">
   General Elliptical
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section class="tex2jax_ignore mathjax_ignore" id="meniscus-model-comparison">
<h1>Meniscus Model Comparison<a class="headerlink" href="#meniscus-model-comparison" title="Permalink to this heading">#</a></h1>
<section id="comparison-of-toroidal-meniscus-models-with-different-profile-shapes">
<h2>Comparison of toroidal meniscus models with different profile shapes<a class="headerlink" href="#comparison-of-toroidal-meniscus-models-with-different-profile-shapes" title="Permalink to this heading">#</a></h2>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>So far all the capillary entry pressures for the percoaltion examples were calculated using the <code class="docutils literal notranslate"><span class="pre">Standard</span></code> physics model which is the <code class="docutils literal notranslate"><span class="pre">Washburn</span></code> model for straight walled capillary tubes. This has been shown to be a bad model for fibrous media where the walls of throats are converging and diverging. In the study <a class="reference external" href="http://link.springer.com/10.1007/s11242-017-0973-2">Capillary Hysteresis in Neutrally Wettable Fibrous Media: A Pore Network Study of a Fuel Cell Electrode</a> percolation in fibrous media was simulated using a meniscus model that assumed the contrictions between fibers are similar to a toroid:</p>
<p><img alt="" src="https://media.giphy.com/media/AIbz7mpqxgc5a/giphy.gif" /></p>
<p>This model was first proposed by Purcell and treats the inner solid profile as a circle. As the fluid invades through the center of the torus the meniscus is pinned to the surface and the “effective” contact angle becomes influenced by the converging diverging geometry and is a function of the filling angle <span class="math notranslate nohighlight">\(\alpha\)</span>. The shape of the meniscus as the invading phase moves upwards through the torus with key model parameters is shown below.</p>
<p><img alt="" src="https://i.imgur.com/b2der2w.png" /></p>
<p>Different intrinsic contact angles through invading phase are shown above: (a) 60<span class="math notranslate nohighlight">\(^\circ\)</span>, (b) 90<span class="math notranslate nohighlight">\(^\circ\)</span> and (c) 120<span class="math notranslate nohighlight">\(^\circ\)</span>. All scenarios clearly show an inflection of the meniscus curvature signifying a switch in the sign of the capillary pressure from negative to positive. This inflection is predicted to occur for all contact angles by the model with varying filling angle. The capillary pressure can be shown to be:</p>
<p><span class="math notranslate nohighlight">\(P_C = -2\sigma cos(\theta-\alpha))/(r+R(1-cos(\alpha))\)</span></p>
<p>A consequence of the circular solid profile is that all fluid behaves as non-wetting fluid because <span class="math notranslate nohighlight">\(\alpha\)</span> can range from -90<span class="math notranslate nohighlight">\(^\circ\)</span> to 90<span class="math notranslate nohighlight">\(^\circ\)</span> degrees and so even if <span class="math notranslate nohighlight">\(\theta\)</span> is 0 then the meniscus is still pinned at zero capillary pressure at the very furthest part of the throat where the <span class="math notranslate nohighlight">\(\alpha\)</span> is 90<span class="math notranslate nohighlight">\(^\circ\)</span></p>
<p>Considering other shapes of solid profile this situation can be avoided. It will be shown by reformulating the Purcell model in a more general way that allows for a flexible defintion of the solid profile that filling angle can be limited to values below 90 and allow for spontaneous imbibition (percolation threshold below zero) of highly wetting fluids.</p>
</section>
<section id="set-up">
<h2>Set up<a class="headerlink" href="#set-up" title="Permalink to this heading">#</a></h2>
<p>We will set up a trivially small network with one throat to demonstrate the use of the meniscus model. Here we do the imports and define a few functions for plotting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">syp</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">lambdify</span><span class="p">,</span> <span class="n">symbols</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">atan</span> <span class="k">as</span> <span class="n">sym_atan</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span> <span class="k">as</span> <span class="n">sym_cos</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span> <span class="k">as</span> <span class="n">sym_sin</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sqrt</span> <span class="k">as</span> <span class="n">sym_sqrt</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">pi</span> <span class="k">as</span> <span class="n">sym_pi</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">fixed</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">fiberRad</span> <span class="o">=</span> <span class="mf">5e-6</span>
<span class="n">throatRad</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">max_bulge</span> <span class="o">=</span> <span class="mf">1e-5</span>
</pre></div>
</div>
</div>
</div>
<p>Now we define our two pore network and add the meniscus model in several modes: ‘max’ returns the maximum pressure experienced by the meniscus as it transitions through the throat, i.e. the burst entry pressure. ‘touch’ is the pressure at which the meniscus has protruded past the throat center a distance defined by the ‘touch_length’ dictionary key. In network simulations this could be set to the pore_diameter. Finally the ‘men’ mode accepts a target_Pc parameter and returns all the mensicus information required for assessing cooperative filling or plotting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openpnm</span> <span class="k">as</span> <span class="nn">op</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = [&#39;svg&#39;]
<span class="kn">import</span> <span class="nn">openpnm.models.physics</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Cubic</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">5e-5</span><span class="p">)</span>
<span class="n">geo</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">SpheresAndCylinders</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">,</span>
                               <span class="n">pores</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">pores</span><span class="p">(),</span>
                               <span class="n">throats</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">throats</span><span class="p">())</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phases</span><span class="o">.</span><span class="n">Water</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>
<span class="n">phase</span><span class="p">[</span><span class="s1">&#39;pore.contact_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta</span>
<span class="n">phys</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">Standard</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">,</span>
                           <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
                           <span class="n">geometry</span><span class="o">=</span><span class="n">geo</span><span class="p">)</span>
<span class="n">geo</span><span class="p">[</span><span class="s1">&#39;throat.diameter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throatRad</span><span class="o">*</span><span class="mi">2</span>
<span class="n">geo</span><span class="p">[</span><span class="s1">&#39;throat.touch_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_bulge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">openpnm.models.physics</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">net</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Cubic</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">5e-5</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">geo</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">SpheresAndCylinders</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>                                <span class="n">pores</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">pores</span><span class="p">(),</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>                                <span class="n">throats</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">throats</span><span class="p">())</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">phase</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phases</span><span class="o">.</span><span class="n">Water</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">phase</span><span class="p">[</span><span class="s1">&#39;pore.contact_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta</span>

<span class="ne">AttributeError</span>: module &#39;openpnm&#39; has no attribute &#39;geometry&#39;
</pre></div>
</div>
</div>
</div>
<p>We define a plotting function that uses the meniscus data:
<span class="math notranslate nohighlight">\(\alpha\)</span> is filling angle as defined above,
<span class="math notranslate nohighlight">\(radius\)</span> is the radius of curvature of the mensicus,
<span class="math notranslate nohighlight">\(center\)</span> is the position of the centre of curvature relative to the throat center along the axis of the throat,
<span class="math notranslate nohighlight">\(\gamma\)</span> is the angle between the throat axis and the line joining the meniscus center and meniscus contact point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_meniscus</span><span class="p">(</span><span class="n">target_Pc</span><span class="p">,</span> <span class="n">meniscus_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">throatRad</span> <span class="o">=</span> <span class="n">geo</span><span class="p">[</span><span class="s1">&#39;throat.diameter&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">phys</span><span class="p">[</span><span class="s1">&#39;pore.contact_angle&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">throat_a</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.scale_a&#39;</span><span class="p">]</span>
    <span class="n">throat_b</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.scale_b&#39;</span><span class="p">]</span>
    <span class="n">x_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span><span class="o">*</span><span class="n">throat_a</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">meniscus_model</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;purcell&#39;</span><span class="p">:</span>
        <span class="c1"># Parameters for plotting fibers</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">rt</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, R, rt, s, t&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">syp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">R</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">rt</span> <span class="o">+</span> <span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">rt</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">rx</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">fiberRad</span><span class="p">,</span> <span class="n">throatRad</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="o">-</span><span class="n">rx</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">fiberRad</span><span class="p">,</span> <span class="n">throatRad</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">);</span>
        <span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.meniscus&#39;</span><span class="p">,</span>
                       <span class="n">model</span><span class="o">=</span><span class="n">meniscus_model</span><span class="p">,</span>
                       <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;men&#39;</span><span class="p">,</span>
                       <span class="n">r_toroid</span><span class="o">=</span><span class="n">fiberRad</span><span class="p">,</span>
                       <span class="n">target_Pc</span><span class="o">=</span><span class="n">target_Pc</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">meniscus_model</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;sinusoidal&#39;</span><span class="p">:</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rt</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, a, b, rt, sigma, theta&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">sym_cos</span><span class="p">(</span><span class="n">sym_pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)))</span><span class="o">*</span><span class="n">b</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">rt</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rt</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">rx</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">throat_a</span><span class="p">,</span> <span class="n">throat_b</span><span class="p">,</span> <span class="n">throatRad</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="o">-</span><span class="n">rx</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">throat_a</span><span class="p">,</span> <span class="n">throat_b</span><span class="p">,</span> <span class="n">throatRad</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">);</span>
        <span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.meniscus&#39;</span><span class="p">,</span>
                       <span class="n">model</span><span class="o">=</span><span class="n">meniscus_model</span><span class="p">,</span>
                       <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;men&#39;</span><span class="p">,</span>
                       <span class="n">r_toroid</span><span class="o">=</span><span class="n">fiberRad</span><span class="p">,</span>
                       <span class="n">target_Pc</span><span class="o">=</span><span class="n">target_Pc</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># General Ellipse</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rt</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, a, b, rt, sigma, theta&#39;</span><span class="p">)</span>
        <span class="n">profile_equation</span> <span class="o">=</span> <span class="n">phys</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">][</span><span class="s1">&#39;profile_equation&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">profile_equation</span> <span class="o">==</span> <span class="s1">&#39;elliptical&#39;</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">sym_sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">b</span>
        <span class="k">elif</span> <span class="n">profile_equation</span> <span class="o">==</span> <span class="s1">&#39;sinusoidal&#39;</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">sym_cos</span><span class="p">(</span><span class="n">sym_pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)))</span><span class="o">*</span><span class="n">b</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">rt</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rt</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">rx</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">throat_a</span><span class="p">,</span> <span class="n">throat_b</span><span class="p">,</span> <span class="n">throatRad</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="o">-</span><span class="n">rx</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">throat_a</span><span class="p">,</span> <span class="n">throat_b</span><span class="p">,</span> <span class="n">throatRad</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">);</span>
        <span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.meniscus&#39;</span><span class="p">,</span>
                       <span class="n">model</span><span class="o">=</span><span class="n">meniscus_model</span><span class="p">,</span>
                       <span class="n">profile_equation</span><span class="o">=</span><span class="n">profile_equation</span><span class="p">,</span>
                       <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;men&#39;</span><span class="p">,</span>
                       <span class="n">target_Pc</span><span class="o">=</span><span class="n">target_Pc</span><span class="p">)</span>
    <span class="n">men_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">men_data</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.meniscus.alpha&#39;</span><span class="p">]</span>
    <span class="n">men_data</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.meniscus.gamma&#39;</span><span class="p">]</span>
    <span class="n">men_data</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.meniscus.radius&#39;</span><span class="p">]</span>
    <span class="n">men_data</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.meniscus.center&#39;</span><span class="p">]</span>
    <span class="n">arc_cen</span> <span class="o">=</span> <span class="n">men_data</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span>
    <span class="n">arc_rad</span> <span class="o">=</span> <span class="n">men_data</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">]</span>
    <span class="n">arc_angle</span> <span class="o">=</span> <span class="n">men_data</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">]</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">arc_angle</span><span class="p">,</span> <span class="n">arc_angle</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">arcx</span> <span class="o">=</span> <span class="n">arc_cen</span> <span class="o">+</span> <span class="n">arc_rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
    <span class="n">arcy</span> <span class="o">=</span> <span class="n">arc_rad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">arcx</span><span class="p">,</span> <span class="n">arcy</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.meniscus.pos&#39;</span><span class="p">],</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.meniscus.rx&#39;</span><span class="p">]);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">ticklabel_format</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">scilimits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="circular-purcell">
<h2>Circular (Purcell)<a class="headerlink" href="#circular-purcell" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circular_model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">meniscus</span><span class="o">.</span><span class="n">purcell</span>

<span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.max&#39;</span><span class="p">,</span>
               <span class="n">model</span><span class="o">=</span><span class="n">circular_model</span><span class="p">,</span>
               <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
               <span class="n">r_toroid</span><span class="o">=</span><span class="n">fiberRad</span><span class="p">)</span>
<span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.touch&#39;</span><span class="p">,</span>
               <span class="n">model</span><span class="o">=</span><span class="n">circular_model</span><span class="p">,</span>
               <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;touch&#39;</span><span class="p">,</span>
               <span class="n">r_toroid</span><span class="o">=</span><span class="n">fiberRad</span><span class="p">)</span>
<span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.meniscus&#39;</span><span class="p">,</span>
               <span class="n">model</span><span class="o">=</span><span class="n">circular_model</span><span class="p">,</span>
               <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;men&#39;</span><span class="p">,</span>
               <span class="n">r_toroid</span><span class="o">=</span><span class="n">fiberRad</span><span class="p">,</span>
               <span class="n">target_Pc</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">touch_Pc</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.touch&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pressure at maximum bulge&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">touch_Pc</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">max_Pc_circle</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.max&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Circular profile critical entry pressure&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">max_Pc_circle</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pressure at maximum bulge 7213.0
Circular profile critical entry pressure 8165.0
</pre></div>
</div>
</div>
</div>
<p>We can see that the touch_Pc calculated earlier, corresponds with the tip of the meniscus exceeding the max_bulge parameter. Try changing this and re-running to see what happens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_meniscus</span><span class="p">(</span><span class="n">target_Pc</span><span class="o">=</span><span class="n">touch_Pc</span><span class="p">,</span> <span class="n">meniscus_model</span><span class="o">=</span><span class="n">circular_model</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">max_bulge</span><span class="p">,</span> <span class="n">max_bulge</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">throatRad</span><span class="p">,</span> <span class="n">throatRad</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1048c87d00&gt;]
</pre></div>
</div>
<img alt="../../_images/708c64734754586640a35bdd53dde1bab7875deabf3298d38fec86f4cfa3705a.svg" src="../../_images/708c64734754586640a35bdd53dde1bab7875deabf3298d38fec86f4cfa3705a.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plot_meniscus</span><span class="p">(</span><span class="n">target_Pc</span><span class="o">=</span><span class="n">max_Pc_circle</span><span class="p">,</span> <span class="n">meniscus_model</span><span class="o">=</span><span class="n">circular_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d888aead3246a656ec4d091ac0824dc94cc4d8b3a2f52c869173bdc273c38321.svg" src="../../_images/d888aead3246a656ec4d091ac0824dc94cc4d8b3a2f52c869173bdc273c38321.svg" /></div>
</div>
<p>We can interact with the mensicus model by changing the target_Pc parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">plot_meniscus</span><span class="p">,</span>
         <span class="n">target_Pc</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="n">max_Pc_circle</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
         <span class="n">meniscus_model</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">circular_model</span><span class="p">),</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="kc">None</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5aec01137eee4af6911347ed18090eba", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.plot_meniscus(target_Pc, meniscus_model=None, ax=None)&gt;
</pre></div>
</div>
<img alt="../../_images/9a0742f5c0e57bd891ad00f8e4d623d07e7ae7468d28fe5f448509460b79b053.svg" src="../../_images/9a0742f5c0e57bd891ad00f8e4d623d07e7ae7468d28fe5f448509460b79b053.svg" /></div>
</div>
<p>Here we can see that the critical entry pressure for the circular profile is positive, even though the intrinsic contact angle is highly non-wetting</p>
</section>
<section id="sinusoidal">
<h2>Sinusoidal<a class="headerlink" href="#sinusoidal" title="Permalink to this heading">#</a></h2>
<p>Now we can start to compare the different meniscus models:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sinusoidal_model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">meniscus</span><span class="o">.</span><span class="n">sinusoidal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">sinusoidal_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function openpnm.models.physics.meniscus.sinusoidal(target, mode=&#39;max&#39;, target_Pc=None, num_points=1000.0, r_toroid=5e-06, throat_diameter=&#39;throat.diameter&#39;, pore_diameter=&#39;pore.diameter&#39;, touch_length=&#39;throat.touch_length&#39;, surface_tension=&#39;pore.surface_tension&#39;, contact_angle=&#39;pore.contact_angle&#39;)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.meniscus&#39;</span><span class="p">,</span>
               <span class="n">model</span><span class="o">=</span><span class="n">sinusoidal_model</span><span class="p">,</span>
               <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;men&#39;</span><span class="p">,</span>
               <span class="n">r_toroid</span><span class="o">=</span><span class="n">fiberRad</span><span class="p">,</span>
               <span class="n">target_Pc</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The equation for the solid sinusoidal profile is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rt</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x, a, b, rt, sigma, theta&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">sym_cos</span><span class="p">(</span><span class="n">sym_pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)))</span><span class="o">*</span><span class="n">b</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">rt</span> <span class="o">+</span> <span class="n">b</span><span class="o">-</span><span class="n">y</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - b \cos{\left(\frac{\pi x}{2 a} \right)} + b + rt\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Derivative of profile</span>
<span class="n">rprime</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">rprime</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{\pi b \sin{\left(\frac{\pi x}{2 a} \right)}}{2 a}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filling angle</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">sym_atan</span><span class="p">(</span><span class="n">rprime</span><span class="p">)</span>
<span class="n">alpha</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \operatorname{atan}{\left(\frac{\pi b \sin{\left(\frac{\pi x}{2 a} \right)}}{2 a} \right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Angle between y axis, meniscus center and meniscus contact point</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">sym_pi</span> <span class="o">-</span> <span class="p">(</span><span class="n">theta</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span>
<span class="n">eta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \theta - \operatorname{atan}{\left(\frac{\pi b \sin{\left(\frac{\pi x}{2 a} \right)}}{2 a} \right)} + \pi\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Angle between x axis, meniscus center and meniscus contact point</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="n">sym_pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">eta</span>
<span class="n">gamma</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \theta + \operatorname{atan}{\left(\frac{\pi b \sin{\left(\frac{\pi x}{2 a} \right)}}{2 a} \right)} - \frac{\pi}{2}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Radius of curvature of meniscus</span>
<span class="n">rm</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="n">sym_cos</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span>
<span class="n">rm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{- b \cos{\left(\frac{\pi x}{2 a} \right)} + b + rt}{\cos{\left(\theta + \operatorname{atan}{\left(\frac{\pi b \sin{\left(\frac{\pi x}{2 a} \right)}}{2 a} \right)} \right)}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Distance along x-axis from center of curvature to meniscus contact point</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">rm</span><span class="o">*</span><span class="n">sym_sin</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{\left(- b \cos{\left(\frac{\pi x}{2 a} \right)} + b + rt\right) \sin{\left(\theta + \operatorname{atan}{\left(\frac{\pi b \sin{\left(\frac{\pi x}{2 a} \right)}}{2 a} \right)} \right)}}{\cos{\left(\theta + \operatorname{atan}{\left(\frac{\pi b \sin{\left(\frac{\pi x}{2 a} \right)}}{2 a} \right)} \right)}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Capillary Pressure</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">/</span><span class="n">rm</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{2 \sigma \cos{\left(\theta + \operatorname{atan}{\left(\frac{\pi b \sin{\left(\frac{\pi x}{2 a} \right)}}{2 a} \right)} \right)}}{- b \cos{\left(\frac{\pi x}{2 a} \right)} + b + rt}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.max&#39;</span><span class="p">,</span>
               <span class="n">model</span><span class="o">=</span><span class="n">sinusoidal_model</span><span class="p">,</span>
               <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
               <span class="n">r_toroid</span><span class="o">=</span><span class="n">fiberRad</span><span class="p">)</span>
<span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.touch&#39;</span><span class="p">,</span>
               <span class="n">model</span><span class="o">=</span><span class="n">sinusoidal_model</span><span class="p">,</span>
               <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;touch&#39;</span><span class="p">,</span>
               <span class="n">r_toroid</span><span class="o">=</span><span class="n">fiberRad</span><span class="p">)</span>
<span class="n">max_Pc_sin</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.max&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_Pc_sin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4729.770413396985
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_meniscus</span><span class="p">(</span><span class="n">target_Pc</span><span class="o">=</span><span class="n">max_Pc_sin</span><span class="p">,</span> <span class="n">meniscus_model</span><span class="o">=</span><span class="n">sinusoidal_model</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/bbfece4928db0550bb9afff1f8847a309238ea3e934d8a7fcd7ed3a2f78b7b2b.svg" src="../../_images/bbfece4928db0550bb9afff1f8847a309238ea3e934d8a7fcd7ed3a2f78b7b2b.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">plot_meniscus</span><span class="p">,</span>
         <span class="n">target_Pc</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="n">max_Pc_sin</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
         <span class="n">meniscus_model</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">sinusoidal_model</span><span class="p">),</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="kc">None</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "039f211a098744379f96eaa7bef4c68c", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.plot_meniscus(target_Pc, meniscus_model=None, ax=None)&gt;
</pre></div>
</div>
<img alt="../../_images/1ece07c3a038ae8a5e628d5c5e0dfbf86bb39d40874bc92e22baefa9319abc7a.svg" src="../../_images/1ece07c3a038ae8a5e628d5c5e0dfbf86bb39d40874bc92e22baefa9319abc7a.svg" /></div>
</div>
<p>Now the crtical entry pressure is negative signifying that spontaneous imbibition will occur</p>
</section>
<section id="general-elliptical">
<h2>General Elliptical<a class="headerlink" href="#general-elliptical" title="Permalink to this heading">#</a></h2>
<p>Similarly we can define an elliptical profile and use the same method to determine the capillary pressure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">sym_sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">b</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle b \sqrt{1 - \frac{x^{2}}{a^{2}}}\]</div>
</div>
</div>
<p>In-fact this is the model that OpenPNM uses for Purcell as well with a = b = fiber radius</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scale ellipse in x direction</span>
<span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.scale_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fiberRad</span>
<span class="c1"># Scale ellipse in y direction</span>
<span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.scale_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fiberRad</span>
<span class="n">general_model</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">meniscus</span><span class="o">.</span><span class="n">general_toroidal</span>
<span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">,</span>
               <span class="n">model</span><span class="o">=</span><span class="n">general_model</span><span class="p">,</span>
               <span class="n">profile_equation</span><span class="o">=</span><span class="s1">&#39;elliptical&#39;</span><span class="p">,</span>
               <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
<span class="n">max_Pc_ellipse</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">max_Pc_ellipse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8165.324889242946
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_meniscus</span><span class="p">(</span><span class="n">target_Pc</span><span class="o">=</span><span class="n">max_Pc_ellipse</span><span class="p">,</span> <span class="n">meniscus_model</span><span class="o">=</span><span class="n">general_model</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../../_images/ceee499f1154e2fe09c2de2564792a92a47ea18a1eba4de3eb67b7968177a0ec.svg" src="../../_images/ceee499f1154e2fe09c2de2564792a92a47ea18a1eba4de3eb67b7968177a0ec.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_Pc_ellipse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8165.324889242946
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">plot_meniscus</span><span class="p">,</span>
         <span class="n">target_Pc</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="n">max_Pc_ellipse</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
         <span class="n">meniscus_model</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">general_model</span><span class="p">),</span>
         <span class="n">ax</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="kc">None</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "19037a073aab4d87a1144bb8e891938c", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.plot_meniscus(target_Pc, meniscus_model=None, ax=None)&gt;
</pre></div>
</div>
<img alt="../../_images/c8b3fc2895dbd608cd590ab453ac7b7652122b577d23bae2b6d0732de07466df.svg" src="../../_images/c8b3fc2895dbd608cd590ab453ac7b7652122b577d23bae2b6d0732de07466df.svg" /></div>
</div>
<p>The two scale factors can now be used to determine a wide range of capillary behaviours with one general model. Below we run the model for a range of scaling factors showing the effect on the sign and magnitude of the entry pressure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">throatRad</span>
<span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.scale_a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">throatRad</span>
<span class="n">elliptical_pressures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sinusoidal_pressures</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bs</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bs</span><span class="p">)):</span>
    <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.scale_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">,</span>
                   <span class="n">model</span><span class="o">=</span><span class="n">general_model</span><span class="p">,</span>
                   <span class="n">profile_equation</span><span class="o">=</span><span class="s1">&#39;elliptical&#39;</span><span class="p">,</span>
                   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
                   <span class="n">num_points</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">Pc</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">]</span>
    <span class="n">elliptical_pressures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pc</span><span class="p">)</span>
    <span class="n">plot_meniscus</span><span class="p">(</span><span class="n">target_Pc</span><span class="o">=</span><span class="n">Pc</span><span class="p">,</span> <span class="n">meniscus_model</span><span class="o">=</span><span class="n">general_model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bs</span><span class="p">)):</span>
    <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.scale_b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">phys</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">,</span>
                   <span class="n">model</span><span class="o">=</span><span class="n">general_model</span><span class="p">,</span>
                   <span class="n">profile_equation</span><span class="o">=</span><span class="s1">&#39;sinusoidal&#39;</span><span class="p">,</span>
                   <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span>
                   <span class="n">num_points</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">Pc</span> <span class="o">=</span> <span class="n">phys</span><span class="p">[</span><span class="s1">&#39;throat.entry_pressure&#39;</span><span class="p">]</span>
    <span class="n">sinusoidal_pressures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Pc</span><span class="p">)</span>
    <span class="n">plot_meniscus</span><span class="p">(</span><span class="n">target_Pc</span><span class="o">=</span><span class="n">Pc</span><span class="p">,</span> <span class="n">meniscus_model</span><span class="o">=</span><span class="n">general_model</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4e49c9920efb961274dbf82d5270fb4b614ade98f9c2e03c2d2459a325cea74d.svg" src="../../_images/4e49c9920efb961274dbf82d5270fb4b614ade98f9c2e03c2d2459a325cea74d.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bs</span><span class="o">/</span><span class="n">throatRad</span><span class="p">,</span> <span class="n">elliptical_pressures</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bs</span><span class="o">/</span><span class="n">throatRad</span><span class="p">,</span> <span class="n">sinusoidal_pressures</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1048287e20&gt;]
</pre></div>
</div>
<img alt="../../_images/a32b973e70f1b67e46895ba0bccfd42249fde89f0a6aea5527e2566b883d53eb.svg" src="../../_images/a32b973e70f1b67e46895ba0bccfd42249fde89f0a6aea5527e2566b883d53eb.svg" /></div>
</div>
<p>Here we can see that the two different shaped profiles lead to quite different capiallary behaviour. The elliptical profile always resuls in positive pressure and the meniscus is basically pinned to the end of the throat where highest pressure occurs as alpha always reaches 90. Whereas the sinusiodal model allows for spontaneous imbibition where a breakthrough may occur at negative capillary pressure for wetting fluids if the wall angle is shallow.</p>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PMEAL.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>