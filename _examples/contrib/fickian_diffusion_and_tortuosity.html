
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Fickian Diffusion and Tortuosity &#8212; OpenPNM 2.8.2.dev111140 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/custom.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/openpnm_logo.jpg" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/openpnm_logo.jpg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../basic_usage.html">
  Basic Usage
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../modules/index.html">
  Module Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../examples/index_old.html">
  Examples (old)
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/issues">Issue Tracker<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/discussions">Get Help<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PMEAL/OpenPNM" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/OpenPNM" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Fickian Diffusion and Tortuosity
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generating-network">
     Generating network
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-geometry-models">
     Add geometry models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-phase-object">
     Add phase object
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-physics-models">
     Add physics models
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#performing-fickian-diffusion">
   Performing Fickian diffusion
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-boundary-conditions">
     Adding boundary conditions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#running-the-algorithm">
     Running the algorithm
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing">
   Post processing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualizing">
     Visualizing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-flux">
     Calculating flux
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section class="tex2jax_ignore mathjax_ignore" id="fickian-diffusion-and-tortuosity">
<h1>Fickian Diffusion and Tortuosity<a class="headerlink" href="#fickian-diffusion-and-tortuosity" title="Permalink to this heading">#</a></h1>
<p>In this example, we will learn how to perform Fickian diffusion on a <code class="docutils literal notranslate"><span class="pre">Cubic</span></code> network. The algorithm works fine with every other network type, but for now we want to keep it simple. Refere to <strong>Tutorials &gt; Network</strong> for more details on different network types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openpnm</span> <span class="k">as</span> <span class="nn">op</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = [&#39;svg&#39;]
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">Workspace</span><span class="p">()</span>
<span class="n">ws</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;loglevel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="generating-network">
<h2>Generating network<a class="headerlink" href="#generating-network" title="Permalink to this heading">#</a></h2>
<p>First, we need to generate a <code class="docutils literal notranslate"><span class="pre">Cubic</span></code> network. For now, we stick to a 2d network, but you might as well try it in 3d!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">spacing</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Cubic</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-geometry-models">
<h2>Add geometry models<a class="headerlink" href="#add-geometry-models" title="Permalink to this heading">#</a></h2>
<p>Next, we need to add geometry models to the generated network. <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> has collections of geometry models ready to add to the network object. Choosing the right geometry models is important to represent the microstructure of different materials such as Toray090 carbon papers, sand stone, electrospun fibers, etc. For now, we will use a simple collection of geometry models for a <code class="docutils literal notranslate"><span class="pre">spheres_and_cylinders</span></code> geometry. These geometry models assume pores are spheres and throats are cylinders.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geo_models</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">spheres_and_cylinders</span>
<span class="n">net</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">geo_models</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>A collection of geometry models should now be added to the network object. Make sure to <code class="docutils literal notranslate"><span class="pre">regenerate_models</span></code> after adding any new models to the network. To view the models that have been added to the network object print the network as follows. Notice how <code class="docutils literal notranslate"><span class="pre">throat.diameter</span></code> and <code class="docutils literal notranslate"><span class="pre">pore.volume</span></code> as well as other shape factor models have been added to the network.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>══════════════════════════════════════════════════════════════════════════════
net : &lt;openpnm.network.Cubic at 0x7fa1941e2090&gt;
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
  #  Properties                                                   Valid Values
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
  1  pore.coordination_number                                        100 / 100
  2  pore.coords                                                     100 / 100
  3  pore.diameter                                                   100 / 100
  4  pore.max_size                                                   100 / 100
  5  pore.seed                                                       100 / 100
  6  pore.volume                                                     100 / 100
  7  throat.conns                                                    180 / 180
  8  throat.cross_sectional_area                                     180 / 180
  9  throat.diameter                                                 180 / 180
 10  throat.diffusive_size_factors                                   180 / 180
 11  throat.hydraulic_size_factors                                   180 / 180
 12  throat.length                                                   180 / 180
 13  throat.lens_volume                                              180 / 180
 14  throat.max_size                                                 180 / 180
 15  throat.spacing                                                  180 / 180
 16  throat.total_volume                                             180 / 180
 17  throat.volume                                                   180 / 180
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
  #  Labels                                                 Assigned Locations
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
  1  pore.back                                                              10
  2  pore.bottom                                                            10
  3  pore.front                                                             10
  4  pore.surface                                                           36
  5  pore.top                                                               10
  6  throat.surface                                                         36
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-phase-object">
<h2>Add phase object<a class="headerlink" href="#add-phase-object" title="Permalink to this heading">#</a></h2>
<p>Next, we need to add a phase to our simulation. A phase object(s) contain(s) thermophysical information about the working fluid(s) in the simulation. <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> has tons of prebuilt phases as well! For this simulation, we use air as our working fluid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">Air</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [5],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">air</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">Air</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>

<span class="nn">File ~/work/OpenPNM/OpenPNM/openpnm/phase/_air.py:29,</span> in <span class="ni">Air.__init__</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">29</span>     <span class="kn">from</span> <span class="nn">thermo</span> <span class="kn">import</span> <span class="n">Mixture</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">Mixture</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o2&#39;</span><span class="p">,</span> <span class="s1">&#39;n2&#39;</span><span class="p">],</span> <span class="n">zs</span><span class="o">=</span><span class="p">[</span><span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>     <span class="n">temp</span> <span class="o">=</span> <span class="n">_fetch_chemical_props</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;thermo&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-physics-models">
<h2>Add physics models<a class="headerlink" href="#add-physics-models" title="Permalink to this heading">#</a></h2>
<p>Next we need to add physics models to the phase object. A collection of physics models depend on both geometry and phase information. Here we add the <code class="docutils literal notranslate"><span class="pre">basic</span></code> collection of physics models. This includes a <code class="docutils literal notranslate"><span class="pre">diffusive_conductance</span></code> model used in fickian diffusion simulations. Other models included in basic are <code class="docutils literal notranslate"><span class="pre">hydraulic_conductance</span></code> and <code class="docutils literal notranslate"><span class="pre">entry_pressure</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phys_models</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">basic</span>
<span class="n">air</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">phys_models</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">air</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="performing-fickian-diffusion">
<h1>Performing Fickian diffusion<a class="headerlink" href="#performing-fickian-diffusion" title="Permalink to this heading">#</a></h1>
<p>Now that everything’s set up, it’s time to perform our Fickian diffusion simulation. For this purpose, we need to add the <code class="docutils literal notranslate"><span class="pre">FickianDiffusion</span></code> algorithm to our simulation. Here’s how we do it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fd</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">FickianDiffusion</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">air</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">network</span></code> and <code class="docutils literal notranslate"><span class="pre">phase</span></code> are required parameters for pretty much every algorithm we add, since we need to specify on which network and for which phase we want to run the algorithm.</p>
<section id="adding-boundary-conditions">
<h2>Adding boundary conditions<a class="headerlink" href="#adding-boundary-conditions" title="Permalink to this heading">#</a></h2>
<p>Next, we need to add some boundary conditions to the simulation. By default, <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> assumes zero flux for the boundary pores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inlet</span>  <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;front&#39;</span><span class="p">)</span> 
<span class="n">outlet</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;back&#39;</span><span class="p">)</span>
<span class="n">C_in</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">C_out</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">fd</span><span class="o">.</span><span class="n">set_value_BC</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">inlet</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">C_in</span><span class="p">)</span>
<span class="n">fd</span><span class="o">.</span><span class="n">set_value_BC</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">outlet</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">C_out</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">set_value_BC</span></code> applies the so-called “Dirichlet” boundary condition to the specified pores. Note that unless you want to apply a single value to all of the specified pores (like we just did), you must pass a list (or <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>) as the <code class="docutils literal notranslate"><span class="pre">values</span></code> parameter.</p>
</section>
<section id="running-the-algorithm">
<h2>Running the algorithm<a class="headerlink" href="#running-the-algorithm" title="Permalink to this heading">#</a></h2>
<p>Now, it’s time to run the algorithm. This is done by calling the <code class="docutils literal notranslate"><span class="pre">run</span></code> method attached to the algorithm object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fd</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                       
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;pore.concentration&#39;: SteadyStateSolution([1.     , 1.     , 1.     , 1.     , 1.     , 1.     ,
                      1.     , 1.     , 1.     , 1.     , 0.91247, 0.90179,
                      0.90063, 0.91127, 0.91092, 0.89035, 0.87522, 0.87787,
                      0.85195, 0.84409, 0.8086 , 0.80099, 0.77881, 0.82206,
                      0.83878, 0.81892, 0.8155 , 0.77651, 0.80579, 0.79607,
                      0.71218, 0.69453, 0.70386, 0.70642, 0.70437, 0.68794,
                      0.687  , 0.66227, 0.69233, 0.73643, 0.63349, 0.63437,
                      0.59717, 0.60263, 0.57961, 0.56621, 0.57162, 0.59177,
                      0.55168, 0.57888, 0.50755, 0.4831 , 0.44376, 0.47502,
                      0.51439, 0.51734, 0.50933, 0.49063, 0.45289, 0.4257 ,
                      0.39291, 0.35487, 0.35859, 0.33091, 0.37506, 0.43326,
                      0.3751 , 0.34388, 0.32536, 0.30339, 0.24265, 0.25011,
                      0.25119, 0.25372, 0.22365, 0.24942, 0.21214, 0.21747,
                      0.20779, 0.20799, 0.08587, 0.12816, 0.14487, 0.1239 ,
                      0.11533, 0.11314, 0.10743, 0.11603, 0.1247 , 0.1043 ,
                      0.     , 0.     , 0.     , 0.     , 0.     , 0.     ,
                      0.     , 0.     , 0.     , 0.     ])}
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="post-processing">
<h1>Post processing<a class="headerlink" href="#post-processing" title="Permalink to this heading">#</a></h1>
<p>When an algorithm is successfully run, the results are attached to the same object. To access the results, you need to know the quantity for which the algorithm was solving. For instance, <code class="docutils literal notranslate"><span class="pre">FickianDiffusion</span></code> solves for the quantity <code class="docutils literal notranslate"><span class="pre">pore.concentration</span></code>, which is somewhat intuitive. However, if you ever forget it, or wanted to manually check the quantity, you can take a look at the algorithm <code class="docutils literal notranslate"><span class="pre">settings</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
Settings                            Values
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
uuid                                8ccd20df-4ccd-496c-9847-026e383fe6db
cache                               True
conductance                         throat.diffusive_conductance
phase                               phase_01
quantity                            pore.concentration
variable_props                      TypedSet()
f_rtol                              1e-06
newton_maxiter                      5000
relaxation_factor                   1.0
x_rtol                              1e-06
――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――――
</pre></div>
</div>
</div>
</div>
<section id="visualizing">
<h2>Visualizing<a class="headerlink" href="#visualizing" title="Permalink to this heading">#</a></h2>
<p>Now that we know the quantity for which <code class="docutils literal notranslate"><span class="pre">FickianDiffusion</span></code> was solved, let’s take a look at the results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">fd</span><span class="p">[</span><span class="s1">&#39;pore.concentration&#39;</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">rate</span><span class="p">(</span><span class="n">throats</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">Ts</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">net</span><span class="p">[</span><span class="s1">&#39;pore.diameter&#39;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">op</span><span class="o">.</span><span class="n">topotools</span><span class="o">.</span><span class="n">plot_coordinates</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">size_by</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">op</span><span class="o">.</span><span class="n">topotools</span><span class="o">.</span><span class="n">plot_connections</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/306a8d746526f076e12d8b02fcddb61976c5b92b3026fb92a90fc20ed6ac6130.svg" src="../../_images/306a8d746526f076e12d8b02fcddb61976c5b92b3026fb92a90fc20ed6ac6130.svg" /></div>
</div>
</section>
<section id="calculating-flux">
<h2>Calculating flux<a class="headerlink" href="#calculating-flux" title="Permalink to this heading">#</a></h2>
<p>You might as well be interested in calculating the mass flux from a boundary! This is easily done in <code class="docutils literal notranslate"><span class="pre">OpenPNM</span></code> via calling the <code class="docutils literal notranslate"><span class="pre">rate</span></code> method attached to the algorithm. Let’s see how it works:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rate_inlet</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">rate</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">inlet</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mass flow rate from inlet: </span><span class="si">{</span><span class="n">rate_inlet</span><span class="si">:</span><span class="s1">.5e</span><span class="si">}</span><span class="s1"> mol/s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mass flow rate from inlet: 7.67614e-12 mol/s
</pre></div>
</div>
</div>
</div>
<p>We can determine the effective diffusivity of the network by solving Fick’s law:</p>
<div class="math notranslate nohighlight">
\[ D_{eff} = \frac{N_A L}{ A \Delta C} \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">spacing</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">spacing</span>
<span class="n">D_eff</span> <span class="o">=</span> <span class="n">rate_inlet</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">C_in</span> <span class="o">-</span> <span class="n">C_out</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:.6E}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">D_eff</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.676140E-07
</pre></div>
</div>
</div>
</div>
<p>And the formation factor can be found since the diffusion coefficient of open air is known:</p>
<div class="math notranslate nohighlight">
\[ F = \frac{D_{AB}}{D_{eff}} \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D_AB</span> <span class="o">=</span> <span class="n">air</span><span class="p">[</span><span class="s1">&#39;pore.diffusivity&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">D_AB</span> <span class="o">/</span> <span class="n">D_eff</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The formation factor is: &#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{0:.6E}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The formation factor is:  2.693473E+01
</pre></div>
</div>
</div>
</div>
<p>The tortuosity is defined as follows:</p>
<div class="math notranslate nohighlight">
\[ \frac{D_{eff}}{D_{AB}} = \frac{\varepsilon}{\tau} \rightarrow \tau = \varepsilon \frac{ D_{AB}}{D_{eff}} \]</div>
<p>Note that finding the tortuosity requires knowing the porosity, which is annoyingly difficult to calculate accurately, so here we will just gloss over the details.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V_p</span> <span class="o">=</span> <span class="n">net</span><span class="p">[</span><span class="s1">&#39;pore.volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">V_t</span> <span class="o">=</span> <span class="n">net</span><span class="p">[</span><span class="s1">&#39;throat.volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">V_bulk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">spacing</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">V_p</span> <span class="o">+</span> <span class="n">V_t</span><span class="p">)</span> <span class="o">/</span> <span class="n">V_bulk</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The porosity is: &#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{0:.6E}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The porosity is:  8.546959E-02
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">D_AB</span> <span class="o">/</span> <span class="n">D_eff</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The tortuosity is:&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">{0:.6E}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tau</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The tortuosity is: 2.302101E+00
</pre></div>
</div>
</div>
</div>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PMEAL.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>