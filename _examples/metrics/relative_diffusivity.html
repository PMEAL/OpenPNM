
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Obtaining Relative Diffusivity Curves &#8212; OpenPNM 2.8.2.dev111140 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/custom.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/openpnm_logo.jpg" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/openpnm_logo.jpg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../basic_usage.html">
  Basic Usage
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../modules/index.html">
  Module Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../examples/index2.html">
  Examples2
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/issues">Issue Tracker<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://github.com/PMEAL/OpenPNM/discussions">Get Help<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PMEAL/OpenPNM" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/OpenPNM" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-network-and-phases">
   Create network and phases
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-ordinary-percolation">
   Apply ordinary percolation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saturation-and-rate-functions">
   Saturation and rate functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-multiphase-conductance">
   Define multiphase conductance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-relative-diffusivities">
   Calculate relative diffusivities
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section class="tex2jax_ignore mathjax_ignore" id="obtaining-relative-diffusivity-curves">
<h1>Obtaining Relative Diffusivity Curves<a class="headerlink" href="#obtaining-relative-diffusivity-curves" title="Permalink to this heading">#</a></h1>
<p>This is an example of calculating relative diffusivity in OpenPNM. The term <strong>relative</strong> indicates the existence of another phase in the medium. The concept of relative property (permeability) in multiphase transport was applied in relative permeability example for a flow problem. In this example the transport mechanism is defined as diffusion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openpnm</span> <span class="k">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = [&#39;svg&#39;]
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="create-network-and-phases">
<h2>Create network and phases<a class="headerlink" href="#create-network-and-phases" title="Permalink to this heading">#</a></h2>
<p>First, we create a network and assign phases and properties in a similar way that we used to do for the other examples. Note that <code class="docutils literal notranslate"><span class="pre">op.models.collections.phase</span></code> is added to assign fluid properties such as diffusivity, surface tension, etc, and <code class="docutils literal notranslate"><span class="pre">op.models.collections.physics</span></code> is added to assign pore-scale models such as entry pressure, conduit conductance. Surface tension info will be used in Invasion percolation in the next step. Here, we assumed a user-defined value for air surface tension and contact angle, as they are not included in <code class="docutils literal notranslate"><span class="pre">collections.phase.air</span></code>. Similarly, a user-defined value for water diffusivity was assumed, as it is not included in <code class="docutils literal notranslate"><span class="pre">collections.phase.water</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pn</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">Cubic</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">pn</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">spheres_and_cylinders</span><span class="p">)</span>
<span class="n">pn</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
<span class="n">air</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">Air</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;air&#39;</span><span class="p">)</span>
<span class="n">air</span><span class="p">[</span><span class="s1">&#39;pore.surface_tension&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.072</span>
<span class="n">air</span><span class="p">[</span><span class="s1">&#39;pore.contact_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">180.0</span>
<span class="n">air</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">air</span><span class="p">)</span>
<span class="n">air</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">basic</span><span class="p">)</span>
<span class="n">air</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">Water</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;water&#39;</span><span class="p">)</span>
<span class="n">water</span><span class="p">[</span><span class="s1">&#39;pore.diffusivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="n">water</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">water</span><span class="p">)</span>
<span class="n">water</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">basic</span><span class="p">)</span>
<span class="n">water</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [2],</span> in <span class="ni">&lt;cell line: 4&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">pn</span><span class="o">.</span><span class="n">add_model_collection</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">spheres_and_cylinders</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">pn</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">air</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">phase</span><span class="o">.</span><span class="n">Air</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;air&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">air</span><span class="p">[</span><span class="s1">&#39;pore.surface_tension&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.072</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">air</span><span class="p">[</span><span class="s1">&#39;pore.contact_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">180.0</span>

<span class="nn">File ~/work/OpenPNM/OpenPNM/openpnm/phase/_air.py:29,</span> in <span class="ni">Air.__init__</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">27</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">28</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">29</span>     <span class="kn">from</span> <span class="nn">thermo</span> <span class="kn">import</span> <span class="n">Mixture</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">Mixture</span><span class="p">(</span><span class="n">IDs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o2&#39;</span><span class="p">,</span> <span class="s1">&#39;n2&#39;</span><span class="p">],</span> <span class="n">zs</span><span class="o">=</span><span class="p">[</span><span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.79</span><span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>     <span class="n">temp</span> <span class="o">=</span> <span class="n">_fetch_chemical_props</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;thermo&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="apply-ordinary-percolation">
<h2>Apply ordinary percolation<a class="headerlink" href="#apply-ordinary-percolation" title="Permalink to this heading">#</a></h2>
<p>To simulate a partially saturated material we first invade some non-wetting phase.  This will be accomplished using the <code class="docutils literal notranslate"><span class="pre">InvasonPercolation</span></code> or <code class="docutils literal notranslate"><span class="pre">OrdinaryPercolation</span></code> algorithm. In both algorithms the invading phase invades the network based on the capillary pressure of the throats in the network. These two algorithms have difference in their percolation algorithm and results. As Invasion percolation was implemented in the relative permeability example, here we choose ordinary percolation to demonstrate how we can use its results. It is assumed that the invading phase is water:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">OP</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">OrdinaryPercolation</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">pn</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">water</span><span class="p">)</span>
<span class="n">OP</span><span class="o">.</span><span class="n">set_inlets</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">))</span>
<span class="n">OP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>In ordinary percolation, occupancies and saturation can be extracted from the results for a capillary pressure point. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OP</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">Pc</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span>
<span class="n">air</span><span class="p">[</span><span class="s1">&#39;pore.occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">water</span><span class="p">[</span><span class="s1">&#39;pore.occupancy&#39;</span><span class="p">]</span>
<span class="n">air</span><span class="p">[</span><span class="s1">&#39;throat.occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">water</span><span class="p">[</span><span class="s1">&#39;throat.occupancy&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="saturation-and-rate-functions">
<h2>Saturation and rate functions<a class="headerlink" href="#saturation-and-rate-functions" title="Permalink to this heading">#</a></h2>
<p>To update calculate the saturation based on occupancy from each pressure point, we created a costum function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sat_update</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">nwp</span><span class="p">,</span> <span class="n">wp</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the saturation of each phase using occupancy information from ordinary percolation.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        network: network</span>
<span class="sd">        nwp : phase</span>
<span class="sd">            non-wetting phase</span>
<span class="sd">        wp : phase</span>
<span class="sd">            wetting phase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pore_mask</span> <span class="o">=</span> <span class="n">nwp</span><span class="p">[</span><span class="s2">&quot;pore.occupancy&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">throat_mask</span> <span class="o">=</span> <span class="n">nwp</span><span class="p">[</span><span class="s2">&quot;throat.occupancy&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">sat_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">network</span><span class="p">[</span><span class="s1">&#39;pore.volume&#39;</span><span class="p">][</span><span class="n">pore_mask</span><span class="p">])</span>
    <span class="n">sat_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">network</span><span class="p">[</span><span class="s1">&#39;throat.volume&#39;</span><span class="p">][</span><span class="n">throat_mask</span><span class="p">])</span>
    <span class="n">sat1</span> <span class="o">=</span> <span class="n">sat_p</span> <span class="o">+</span> <span class="n">sat_t</span>
    <span class="n">bulk</span> <span class="o">=</span> <span class="n">network</span><span class="p">[</span><span class="s1">&#39;pore.volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">network</span><span class="p">[</span><span class="s1">&#39;throat.volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">sat</span> <span class="o">=</span> <span class="n">sat1</span><span class="o">/</span><span class="n">bulk</span>
    <span class="k">return</span> <span class="n">sat</span>
</pre></div>
</div>
</div>
</div>
<p>Similar to the relative permeability example, the geometrical parameters in relative diffusivity can cancell out. Therefore,  the remaining fraction includes diffusion rates as follows:</p>
<p><span class="math notranslate nohighlight">\(D_{r}=\frac {D_{eff-multiphase}}{D_{eff-single phase}}=\frac {Rate_{multiphase}}{Rate_{single phase}}\)</span></p>
<p>Where <span class="math notranslate nohighlight">\(Rate_{multiphase}\)</span> is the inlet diffusion rate of the phase (water/air) for a Fickian diffusion algorithm with <code class="docutils literal notranslate"><span class="pre">multiphase</span> <span class="pre">conduit_conductance</span></code> assigned as conduit diffusive conductance model to account for the existence of the other phase. Whereas <span class="math notranslate nohighlight">\(Rate_{single phase}\)</span> is the inlet diffusion rate of the phase (water/air) for a Fickian diffusion algorithm with <code class="docutils literal notranslate"><span class="pre">generic_diffusive_conductance</span></code> assigned as diffusive conductance model for a single phase flow.</p>
<p>Note that <span class="math notranslate nohighlight">\(D_{eff-single phase}\)</span> is a property of the porous material, not the fluid. However, here to cancel out diffusivity in the <span class="math notranslate nohighlight">\(D_{r}\)</span> fraction, the same phase must be used to calculate <span class="math notranslate nohighlight">\(Rate_{single phase}\)</span>. Therefore, we only need to find the rate values for calcuating the relative permeability.
We define a function <code class="docutils literal notranslate"><span class="pre">Rate_calc</span></code>, which simulates a Fickian diffusion given the diffusive conductance keyword and returns the rate diffusion at inlet pores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Rate_calc</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">inlet</span><span class="p">,</span> <span class="n">outlet</span><span class="p">,</span> <span class="n">conductance</span><span class="p">):</span>
        <span class="n">phase</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
        <span class="n">Fd</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">FickianDiffusion</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
        <span class="n">Fd</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">_update</span><span class="p">({</span><span class="s1">&#39;conductance&#39;</span> <span class="p">:</span> <span class="n">conductance</span><span class="p">})</span>
        <span class="n">Fd</span><span class="o">.</span><span class="n">set_value_BC</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">inlet</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Fd</span><span class="o">.</span><span class="n">set_value_BC</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">outlet</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">Fd</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Fd</span><span class="o">.</span><span class="n">rate</span><span class="p">(</span><span class="n">pores</span><span class="o">=</span><span class="n">inlet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">val</span>
</pre></div>
</div>
</div>
</div>
<p>In this example we are focusing on finding the relative diffusivities in x direction. A similar procedure can be applied on y and z directions. Letâ€™s define inlet and outlet pores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff_in</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">diff_out</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pores</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-multiphase-conductance">
<h2>Define multiphase conductance<a class="headerlink" href="#define-multiphase-conductance" title="Permalink to this heading">#</a></h2>
<p>Similar to the relative permeability example, multiphase conductance models are assigned to account for the presence of the other phase:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_mp_cond</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">physics</span><span class="o">.</span><span class="n">multiphase</span><span class="o">.</span><span class="n">conduit_conductance</span>
<span class="n">air</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_mp_cond</span><span class="p">,</span> <span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.conduit_diffusive_conductance&#39;</span><span class="p">,</span>
              <span class="n">throat_conductance</span><span class="o">=</span><span class="s1">&#39;throat.diffusive_conductance&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">regen_mode</span><span class="o">=</span><span class="s1">&#39;deferred&#39;</span><span class="p">)</span>
<span class="n">water</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_mp_cond</span><span class="p">,</span> <span class="n">propname</span><span class="o">=</span><span class="s1">&#39;throat.conduit_diffusive_conductance&#39;</span><span class="p">,</span>
              <span class="n">throat_conductance</span><span class="o">=</span><span class="s1">&#39;throat.diffusive_conductance&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">regen_mode</span><span class="o">=</span><span class="s1">&#39;deferred&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-relative-diffusivities">
<h2>Calculate relative diffusivities<a class="headerlink" href="#calculate-relative-diffusivities" title="Permalink to this heading">#</a></h2>
<p>Now that we have defined the required models and functions, we can find the relative diffusivity of phases over a range of saturation. The saturation points are found at a range of invasion pressure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Snwparr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">reldiff_nwp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">reldiff_wp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">Pc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">OP</span><span class="p">[</span><span class="s1">&#39;pore.invasion_pressure&#39;</span><span class="p">]):</span>
    <span class="n">water</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">OP</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">Pc</span><span class="o">=</span><span class="n">Pc</span><span class="p">))</span>
    <span class="n">air</span><span class="p">[</span><span class="s1">&#39;pore.occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">water</span><span class="p">[</span><span class="s1">&#39;pore.occupancy&#39;</span><span class="p">]</span>
    <span class="n">air</span><span class="p">[</span><span class="s1">&#39;throat.occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">water</span><span class="p">[</span><span class="s1">&#39;throat.occupancy&#39;</span><span class="p">]</span>
    <span class="n">air</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
    <span class="n">water</span><span class="o">.</span><span class="n">regenerate_models</span><span class="p">()</span>
    <span class="n">sat_point</span> <span class="o">=</span> <span class="n">sat_update</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">water</span><span class="p">,</span> <span class="n">air</span><span class="p">)</span>
    <span class="n">Snwparr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sat_point</span><span class="p">)</span>
    <span class="n">Rate_single_nwp</span> <span class="o">=</span> <span class="n">Rate_calc</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">air</span><span class="p">,</span> <span class="n">diff_in</span><span class="p">,</span> <span class="n">diff_out</span><span class="p">,</span> <span class="n">conductance</span> <span class="o">=</span> <span class="s1">&#39;throat.diffusive_conductance&#39;</span><span class="p">)</span>
    <span class="n">Rate_single_wp</span> <span class="o">=</span> <span class="n">Rate_calc</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">water</span><span class="p">,</span> <span class="n">diff_in</span><span class="p">,</span> <span class="n">diff_out</span><span class="p">,</span> <span class="n">conductance</span> <span class="o">=</span> <span class="s1">&#39;throat.diffusive_conductance&#39;</span><span class="p">)</span>
    <span class="n">Rate_mult_nwp</span> <span class="o">=</span> <span class="n">Rate_calc</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">air</span><span class="p">,</span> <span class="n">diff_in</span><span class="p">,</span> <span class="n">diff_out</span><span class="p">,</span> <span class="n">conductance</span> <span class="o">=</span> <span class="s1">&#39;throat.conduit_diffusive_conductance&#39;</span><span class="p">)</span>
    <span class="n">Rate_mult_wp</span> <span class="o">=</span> <span class="n">Rate_calc</span><span class="p">(</span><span class="n">pn</span><span class="p">,</span> <span class="n">water</span><span class="p">,</span> <span class="n">diff_in</span><span class="p">,</span> <span class="n">diff_out</span><span class="p">,</span> <span class="n">conductance</span> <span class="o">=</span> <span class="s1">&#39;throat.conduit_diffusive_conductance&#39;</span><span class="p">)</span>
    <span class="n">reldiff_nwp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rate_mult_nwp</span><span class="o">/</span><span class="n">Rate_single_nwp</span><span class="p">)</span>
    <span class="n">reldiff_wp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rate_mult_wp</span><span class="o">/</span><span class="n">Rate_single_wp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                                                                                                                       
</pre></div>
</div>
</div>
</div>
<p>Plotting the curves:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Snwparr</span><span class="p">,</span> <span class="n">reldiff_nwp</span><span class="p">,</span> <span class="s1">&#39;*-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dr_nwp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Snwparr</span><span class="p">,</span> <span class="n">reldiff_wp</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Dr_wp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Snwp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dr&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Relative Diffusivity in x direction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1a0070c79d0&gt;
</pre></div>
</div>
<img alt="../../_images/3fcbbe6f84d9cd45cfd3576d99be013e3a3fb5c10d874d5a3bb6127258130512.svg" src="../../_images/3fcbbe6f84d9cd45cfd3576d99be013e3a3fb5c10d874d5a3bb6127258130512.svg" /></div>
</div>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, PMEAL.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>